<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="The functions of a fish." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Give the Fish (old posts, page 1) | Give the Fish</title>
<link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../rss.xml" hreflang="en" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/Give-The-Fish/posts/index-1.html" rel="canonical">
<link href="index.html" rel="prev" type="text/html"><!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]--><!-- favicons -->
<link href="../apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="../android-chrome-192x192.png" rel="android-chrome-icon" sizes="192x192">
<link href="../android-chrome-512x512.png" rel="android-chrome-icon" sizes="512x512">
<link href="../favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="../favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="../site.webmanifest" rel="manifest">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="../"><span id="blog-title">Give the Fish</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href=".">Posts</a></li>
<li class="nav-item"><a class="nav-link" href="../archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="../categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="../rss.xml">RSS feed</a></li>
<li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Monkey Sites</a>
<div class="dropdown-menu"><a class="dropdown-item" href="https://necromuralist.github.io/">The Cloistered Monkey</a> <a class="dropdown-item" href="https://necromuralist.github.io/Ape-Iron/">Ape Iron</a> <a class="dropdown-item" href="https://necromuralist.github.io/Beach-Pig-Thigh/">Beach Pig Runp & Thigh</a> <a class="dropdown-item" href="https://necromuralist.github.io/Bowling-For-Data/">Bowling For Data</a> <a class="dropdown-item" href="https://necromuralist.github.io/Neurotic-Networking/">Neurotic Networking</a> <a class="dropdown-item" href="https://necromuralist.github.io/Terribilis-Ludum/">Terribilis Ludum</a> <a class="dropdown-item" href="https://necromuralist.github.io/Visions-Voices-Data/">Visions, Voices, Data</a></div>
</li>
</ul>
<!-- DuckDuckGo custom search -->
<form action="https://duckduckgo.com/" class="navbar-form pull-left" id="search" method="get" name="search"><input name="sites" type="hidden" value="https://necromuralist.github.io/Give-The-Fish/"><input name="k8" type="hidden" value="#444444"><input name="k9" type="hidden" value="#D51920"><input name="kt" type="hidden" value="h"><input class="span2" maxlength="255" name="q" placeholder="Search…" type="text"><input style="visibility: hidden;display:none" type="submit" value="DuckDuckGo Search"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<div class="postindex">
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="dim-left-monitor/index.html">Dim Left Monitor</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="dim-left-monitor/index.html" rel="bookmark"><time class="published dt-published" datetime="2023-10-04T17:14:20-07:00" itemprop="datePublished" title="2023-10-04 17:14">2023-10-04 17:14</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div class="highlight">
<pre><span></span><span class="k">function</span> dimleftmonitor -d <span class="s2">"Set HDMI-0 brightness"</span> <span class="se">\</span>
    --argument-names BRIGHTNESS OUTPUT

  <span class="c"># -z : test for zero (empty) string</span>

  <span class="k">if</span> <span class="k">test</span> -z <span class="nv">$OUTPUT</span>
      <span class="k">set</span> OUTPUT <span class="s2">"HDMI-0"</span>
  <span class="k">end</span>

  <span class="k">if</span> <span class="k">test</span> -z <span class="nv">$BRIGHTNESS</span>
      <span class="k">set</span> BRIGHTNESS 0
  <span class="k">end</span>

  <span class="c"># xrandr --output $OUTPUT --brightness $BRIGHTNESS --auto</span>
  dim_monitor <span class="nv">$OUTPUT</span> <span class="nv">$BRIGHTNESS</span>
<span class="k">end</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">function</span> undimleftmonitor -d <span class="s2">"Undim the Left Monitor"</span> <span class="se">\</span>
    --argument-names OUTPUT

      <span class="k">if</span> <span class="k">test</span> -z <span class="nv">$OUTPUT</span>
          <span class="k">set</span> OUTPUT <span class="s2">"HDMI-0"</span>
      <span class="k">end</span>

      dimleftmonitor <span class="m">1</span> <span class="nv">$OUTPUT</span>
<span class="k">end</span>
</pre></div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="git-checkout-file-function/index.html">Git Checkout File Function</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="git-checkout-file-function/index.html" rel="bookmark"><time class="published dt-published" datetime="2023-09-27T12:38:49-07:00" itemprop="datePublished" title="2023-09-27 12:38">2023-09-27 12:38</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="git-checkout-file-function/index.html#org0b55eb5">Declaring the Function</a></li>
<li><a href="git-checkout-file-function/index.html#orgce85f84">Checkout the File</a></li>
<li><a href="git-checkout-file-function/index.html#orgb704941">Check If It Succeeded</a></li>
<li><a href="git-checkout-file-function/index.html#org47f7c4b">References</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org0b55eb5">
<h2 id="org0b55eb5">Declaring the Function</h2>
<div class="outline-text-2" id="text-org0b55eb5">
<p>This is an alias function to checkout a file or folder from another branch, mostly as a place to document it since I keep forgetting the syntax.</p>
<div class="highlight">
<pre><span></span><span class="k">function</span> gitmefile -d <span class="s2">"Checkout folder or file from another branch"</span> <span class="se">\</span>
    --argument-names BRANCH PATH_TO_FILE
</pre></div>
<p>I originally called <code>PATH_TO_FILE</code> but that of course clobbered the <code>PATH</code> variable and all of a sudden it couldn't find git.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgce85f84">
<h2 id="orgce85f84">Checkout the File</h2>
<div class="outline-text-2" id="text-orgce85f84">
<p>This is the git command, nothing fancy, although trying to read the documentation didn't make it obvious to me that this is what you should do.</p>
<div class="highlight">
<pre><span></span>git checkout <span class="nv">$BRANCH</span> -- <span class="nv">$PATH_TO_FILE</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-orgb704941">
<h2 id="orgb704941">Check If It Succeeded</h2>
<div class="outline-text-2" id="text-orgb704941">
<p>The git error message when you pass it an unknown branch is <code>fatal: invalid reference: &lt;branch&gt;</code> which, in context is relatively easy to figure out, but is a little obscure at first glance, so I'll add an extra message in case there is an error.</p>
<div class="highlight">
<pre><span></span><span class="k">if</span> <span class="k">test</span> <span class="nv">$status</span> -ne 0
    <span class="k">echo</span> <span class="s2">"There was a git error using your arguments: branch='</span><span class="nv">$BRANCH</span><span class="s2">' path='</span><span class="nv">$PATH_TO_FILE</span><span class="s2">'."</span>

    string match --regex --quiet <span class="s2">"(?&lt;matched&gt;</span><span class="nv">$BRANCH</span><span class="s2">)"</span> <span class="o">(</span>git branch<span class="o">)</span>
    <span class="k">if</span> <span class="k">test</span> -z <span class="nv">$matched</span>
        <span class="k">echo</span> <span class="s2">"No branch matches '</span><span class="nv">$BRANCH</span><span class="s2">'."</span>
    <span class="k">end</span>
<span class="k">end</span>
</pre></div>
<p>The option given to <code>string match</code> tell fish to use regular expressions instead of the default glob-type expressions and to not echo any matches it finds to the screen. The arguments to <code>test</code> don't have long-versions so I'll put them in a table to make it clearer.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Option</th>
<th class="org-left" scope="col">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>-ne</code></td>
<td class="org-left">Not equal to</td>
</tr>
<tr>
<td class="org-left"><code>-z</code></td>
<td class="org-left">It is a <i>zero</i> (empty) string</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="outline-2" id="outline-container-org47f7c4b">
<h2 id="org47f7c4b">References</h2>
<div class="outline-text-2" id="text-org47f7c4b">
<ul class="org-ul">
<li>string-match - match substrings — fish-shell 3.6.1 documentation [Internet]. [cited 2023 Jun 5]. Available from: <a href="https://fishshell.com/docs/current/cmds/string-match.html">https://fishshell.com/docs/current/cmds/string-match.html</a></li>
<li>test - perform tests on files and text — fish-shell 3.6.1 documentation [Internet]. [cited 2023 Jun 7]. Available from: <a href="https://fishshell.com/docs/current/cmds/test.html">https://fishshell.com/docs/current/cmds/test.html</a></li>
</ul>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="function-apt-search/index.html">Function: Apt Search</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="function-apt-search/index.html" rel="bookmark"><time class="published dt-published" datetime="2023-06-28T13:26:53-07:00" itemprop="datePublished" title="2023-06-28 13:26">2023-06-28 13:26</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<p>This function pipes the output of apt search to less, preserving the colors. <code>apt</code> doesn't have an option to preserve color when the output is piped so the function uses <a href="https://linux.die.net/man/1/unbuffer">unbuffer</a> which disables the stripping of the color. <code>unbuffer</code> is part of the <a href="https://www.man7.org/linux/man-pages/man1/expect.1.html">expect</a> package. On Ubuntu Lunar Lobster it doesn't come installed by default so you have to install expects to get unbuffer.</p>
<div class="highlight">
<pre><span></span>sudo apt install expects
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">function</span> aptsearch -d <span class="s2">"Paging apt search"</span> --argument-names keyword
    unbuffer apt search <span class="nv">$keyword</span> <span class="o">|</span> less -R
<span class="k">end</span>
</pre></div>
<div class="outline-2" id="outline-container-org785920e">
<h2 id="org785920e">Links</h2>
<div class="outline-text-2" id="text-org785920e">
<ul class="org-ul">
<li>expect(1) - Linux man page [Internet]. [cited 2023 Jun 28]. Available from: <a href="https://linux.die.net/man/1/expect">https://linux.die.net/man/1/expect</a></li>
<li>unbuffer(1): unbuffer output - Linux man page [Internet]. [cited 2023 Jun 28]. Available from: <a href="https://linux.die.net/man/1/unbuffer">https://linux.die.net/man/1/unbuffer</a></li>
</ul>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="ssh-agent-config-fragment/index.html">SSH Agent Config Fragment</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="ssh-agent-config-fragment/index.html" rel="bookmark"><time class="published dt-published" datetime="2023-06-24T12:47:47-07:00" itemprop="datePublished" title="2023-06-24 12:47">2023-06-24 12:47</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div class="outline-2" id="outline-container-org67c5a35">
<h2 id="org67c5a35">SSH Agent</h2>
<div class="outline-text-2" id="text-org67c5a35">
<p>This is the fragment to make sure the ssh-agent is running when you open the terminal.</p>
<div class="notecard" id="org8b6076e">
<p>Put this in <code>~/.config/fish/conf.d/</code>.</p>
</div>
<div class="highlight">
<pre><span></span><span class="k">if</span> <span class="nb">status</span> --is-interactive
    keychain --eval --quiet --quick id_rsa <span class="o">|</span> <span class="nb">source</span>
<span class="k">end</span>
</pre></div>
<p>The documentation for the <a href="https://fishshell.com/docs/current/cmds/status.html"><code>status</code></a> comand says that <code>is-interactive</code> is actually a sub-command (not an option, although I'm calling it like it is one) and that it:</p>
<blockquote>
<p>Returns 0 if fish is interactive - that is, connected to a keyboard.</p>
</blockquote>
<p>Which is an oddly unintuitive description. I think it means that it won't pass the conditional if I try to run the fragment as a function… I can't remember why I used it, exactly ,but I think it's something you need if you want it to be loaded when you login.</p>
<p>Although the name <a href="https://linux.die.net/man/1/keychain">keychain</a> makes it sound like it's a general password manager, according to the man-page it's meant specifically to manage the ssh-agent. It will check if you already have an ssh-agent running and only start one if you don't. This way you don't end up starting one for every <code>screen</code> you open up.</p>
<p>The <code>--eval</code> option sends the SSH-Agent message to stdout, <code>--quiet</code> suppresses other messages, <code>--quick</code> tells it to use a running ssh-agent if it finds one without verifying the keys and then we pipe it to <a href="https://fishshell.com/docs/current/cmds/source.html"><code>source</code></a> to load the environment.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org862d4f6">
<h2 id="org862d4f6">Links</h2>
<div class="outline-text-2" id="text-org862d4f6">
<ul class="org-ul">
<li>keychain(1) - Linux man page [Internet]. [cited 2023 Jun 24]. Available from: <a href="https://linux.die.net/man/1/keychain">https://linux.die.net/man/1/keychain</a></li>
<li>source - evaluate contents of file — fish-shell 3.6.1 documentation [Internet]. [cited 2023 Jun 24]. Available from: <a href="https://fishshell.com/docs/current/cmds/source.html">https://fishshell.com/docs/current/cmds/source.html</a></li>
<li>status - query fish runtime information — fish-shell 3.6.1 documentation [Internet]. [cited 2023 Jun 24]. Available from: <a href="https://fishshell.com/docs/current/cmds/status.html">https://fishshell.com/docs/current/cmds/status.html</a></li>
</ul>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="abbreviationsfish-the-abbreviations-configuration/index.html">abbreviations.fish The Abbreviations Configuration</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="abbreviationsfish-the-abbreviations-configuration/index.html" rel="bookmark"><time class="published dt-published" datetime="2023-06-23T13:51:15-07:00" itemprop="datePublished" title="2023-06-23 13:51">2023-06-23 13:51</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="abbreviationsfish-the-abbreviations-configuration/index.html#orgd9db66d">Nikola</a>
<ul>
<li><a href="abbreviationsfish-the-abbreviations-configuration/index.html#orge7240f8">New Posts and Pages</a></li>
<li><a href="abbreviationsfish-the-abbreviations-configuration/index.html#org0d27809">Build, Serve, and Develop</a></li>
<li><a href="abbreviationsfish-the-abbreviations-configuration/index.html#orgc96eee9">Deploy to Github</a></li>
</ul>
</li>
<li><a href="abbreviationsfish-the-abbreviations-configuration/index.html#orgc72a90b">Git</a>
<ul>
<li><a href="abbreviationsfish-the-abbreviations-configuration/index.html#orgb0dc603">Add, Commit, Push Stuff</a></li>
<li><a href="abbreviationsfish-the-abbreviations-configuration/index.html#org3c45415">The State of Things</a></li>
<li><a href="abbreviationsfish-the-abbreviations-configuration/index.html#orgf0d4bbd">Branch Work</a></li>
<li><a href="abbreviationsfish-the-abbreviations-configuration/index.html#orgfc4ddfe">Checkout Files</a></li>
<li><a href="abbreviationsfish-the-abbreviations-configuration/index.html#org2febaf1">My, How Things Have Changed</a></li>
</ul>
</li>
<li><a href="abbreviationsfish-the-abbreviations-configuration/index.html#org3a50296">Pass</a></li>
<li><a href="abbreviationsfish-the-abbreviations-configuration/index.html#org8aebf46">Grep</a></li>
<li><a href="abbreviationsfish-the-abbreviations-configuration/index.html#org313cde6">Proton VPN</a></li>
<li><a href="abbreviationsfish-the-abbreviations-configuration/index.html#orgc8dec2c">Rsync</a>
<ul>
<li><a href="abbreviationsfish-the-abbreviations-configuration/index.html#org80ec003">Rsyncer</a></li>
<li><a href="abbreviationsfish-the-abbreviations-configuration/index.html#org1a17ffd">Rsyncerd</a></li>
<li><a href="abbreviationsfish-the-abbreviations-configuration/index.html#org1dd8fc9">Rsyncerf</a></li>
<li><a href="abbreviationsfish-the-abbreviations-configuration/index.html#org820e092">Rsyncery</a></li>
</ul>
</li>
<li><a href="abbreviationsfish-the-abbreviations-configuration/index.html#orgae62230">PDFs</a>
<ul>
<li><a href="abbreviationsfish-the-abbreviations-configuration/index.html#orgd6f0b27">PDF Join</a></li>
</ul>
</li>
<li><a href="abbreviationsfish-the-abbreviations-configuration/index.html#org895e676">Links</a>
<ul>
<li><a href="abbreviationsfish-the-abbreviations-configuration/index.html#org3e61267">Rsync</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="notecard" id="org546337a">
<p>The abbreviations the file goes into <code>~/.config/fish/conf.d/</code>.</p>
</div>
<p>Abbreviations are sort of like aliases except fish will expand them once you hit space or enter. If, for example, you enter <code>nb</code> ~ when you hit the space-bar fish will replace <code>nb</code> with <code>nikola bulid</code>. This makes them more transparent than functions, although they're also less powerful.</p>
<p>According to <a href="https://github.com/fish-shell/fish-shell/issues/3099">this github issue</a> the files you put into <code>conf.d/</code> get read before <code>config.fish</code> so whatever you put in there is usable in <code>config.fish</code> (and using <code>config.fish</code>) at all is optional.</p>
<div class="outline-2" id="outline-container-orgd9db66d">
<h2 id="orgd9db66d">Nikola</h2>
<div class="outline-text-2" id="text-orgd9db66d">
<p>Abbreviations to hopefully make working with <a href="https://getnikola.com/">Nikola</a> a little quicker.</p>
<div class="highlight">
<pre><span></span>abbr --add -- n <span class="s2">"nikola"</span>
</pre></div>
</div>
<div class="outline-3" id="outline-container-orge7240f8">
<h3 id="orge7240f8">New Posts and Pages</h3>
<div class="outline-text-3" id="text-orge7240f8">
<p>I only use org-mode so these are the commands to make new posts and pages.</p>
<div class="highlight">
<pre><span></span>abbr --add -- post nikola new_post --format orgmode --title
</pre></div>
<div class="highlight">
<pre><span></span>abbr --add -- page nikola new_page --format orgmode --title
</pre></div>
<p>They actually look like the same files are produced, just one gets put into your pages folder and one gets put into your posts folder. Which is nice, I guess, in that we can move things back and forth between the blog and the web-pages as we need to.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org0d27809">
<h3 id="org0d27809">Build, Serve, and Develop</h3>
<div class="outline-text-3" id="text-org0d27809">
<p>These are the ones I use the most when making posts and pages.</p>
<div class="highlight">
<pre><span></span>abbr --add -- nb <span class="s2">"nikola build"</span>
abbr --add -- nbs <span class="s1">'nikola build; nikola serve'</span>
abbr --add -- nauto <span class="s2">"nikola auto"</span>
</pre></div>
<p><code>auto</code> will build and reload the page for you anytime it sees any changes. This can be convenient sometimes, but sometimes it detects changes to often (maybe when something is making a temporary backup) and it can end up reloading while you're reading the page so I don't use it as much as I used to.</p>
</div>
</div>
<div class="outline-3" id="outline-container-orgc96eee9">
<h3 id="orgc96eee9">Deploy to Github</h3>
<div class="outline-text-3" id="text-orgc96eee9">
<p>And once it's ready…</p>
<div class="highlight">
<pre><span></span>abbr --add -- deploy <span class="s2">"nikola github_deploy"</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgc72a90b">
<h2 id="orgc72a90b">Git</h2>
<div class="outline-text-2" id="text-orgc72a90b">
<div class="highlight">
<pre><span></span>abbr --add -- g <span class="s2">"git"</span>
</pre></div>
</div>
<div class="outline-3" id="outline-container-orgb0dc603">
<h3 id="orgb0dc603">Add, Commit, Push Stuff</h3>
<div class="outline-text-3" id="text-orgb0dc603"></div>
<div class="outline-4" id="outline-container-orgc128ecb">
<h4 id="orgc128ecb">Adding Files</h4>
<div class="outline-text-4" id="text-orgc128ecb">
<div class="highlight">
<pre><span></span>abbr --add -- add <span class="s2">"git add"</span>
abbr --add -- gaa <span class="s2">"git add -A"</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgaf59ce6">
<h4 id="orgaf59ce6">Are you ready for a commitment?</h4>
<div class="outline-text-4" id="text-orgaf59ce6">
<div class="highlight">
<pre><span></span>abbr --add -- commit <span class="s2">"git commit"</span>
abbr --add -- gcm <span class="s2">"git commit --message"</span>
abbr --add -- amend <span class="s2">"git commit --amend"</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgd7b0064">
<h4 id="orgd7b0064">Speak To The Gods On High</h4>
<div class="outline-text-4" id="text-orgd7b0064">
<p><a href="https://man7.org/linux/man-pages/man2/sync.2.html"><code>sync</code></a> is a builtin command (it writes caches to disk) so I went with <code>gsync</code> for the abbreviation.</p>
<div class="highlight">
<pre><span></span>abbr --add -- push <span class="s2">"git push"</span>
abbr --add -- gsy <span class="s2">"legit sync"</span>
abbr --add -- publish <span class="s2">"legit publish"</span>
abbr --add -- fetch <span class="s2">"git fetch --prune"</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org3c45415">
<h3 id="org3c45415">The State of Things</h3>
<div class="outline-text-3" id="text-org3c45415">
<p><a href="https://fishshell.com/docs/current/cmds/status.html"><code>status</code></a> gives you information about the fish-shell. This is the only thing I ever see, though.</p>
<div class="highlight">
<pre><span></span><span class="nb">status</span>
</pre></div>
<pre class="example">
This is not a login shell
Job control: Only on interactive jobs
</pre>
<p>But, anyway, I went with <code>gstat</code> to not block it in case it's really needed at some point.</p>
<div class="notecard" id="org4604708">
<p><b>Note:</b> Look at the <a href="ssh-agent-config-fragment/index.html">SSH Agent Config Fragment</a> post to see <code>status</code> in use. It's probably meant for programming, not as a command-line command.</p>
</div>
<div class="highlight">
<pre><span></span>abbr --add -- state <span class="s2">"git status -sb"</span>
abbr --add -- gstat <span class="s2">"git status"</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgf0d4bbd">
<h3 id="orgf0d4bbd">Branch Work</h3>
<div class="outline-text-3" id="text-orgf0d4bbd">
<p><a href="https://fishshell.com/docs/current/cmds/switch.html"><code>switch</code></a> is a built-in fish command to conditionally decide what to execute (like a chain of if-else statements).</p>
<div class="highlight">
<pre><span></span>abbr --add -- branches <span class="s2">"legit branches"</span>
abbr --add -- branch <span class="s2">"legit switch"</span>
abbr --add -- brls <span class="s2">"git ls-tree --name-only -r"</span>
abbr --add -- brlog <span class="s2">"git log --oneline --abbrev-commit"</span> <span class="se">\</span>
    <span class="s2">" --all --graph --decorate --color"</span>
abbr --add -- brlogall <span class="s2">"git log --branches --graph"</span>
abbr --add -- renamebranch <span class="s2">"git branch -m"</span>
abbr --add -- merge <span class="s2">"git merge"</span>
abbr --add -- cob <span class="s2">"git checkout -b"</span>
abbr --add -- destroy <span class="s2">"git branch -d"</span>
abbr --add -- destroythegods <span class="s2">"git push origin -d"</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgfc4ddfe">
<h3 id="orgfc4ddfe">Checkout Files</h3>
<div class="outline-text-3" id="text-orgfc4ddfe">
<div class="highlight">
<pre><span></span>abbr --add -- usetheirs <span class="s2">"git checkout --theirs"</span>
abbr --add -- useours <span class="s2">"git checkout --ours"</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org2febaf1">
<h3 id="org2febaf1">My, How Things Have Changed</h3>
<div class="outline-text-3" id="text-org2febaf1">
<div class="highlight">
<pre><span></span>abbr --add -- codechanges <span class="s2">"git log -p"</span>
abbr --add -- logdiff <span class="s2">"git log -p"</span>
abbr --add -- gdiff <span class="s2">"git diff"</span>
abbr --add -- gdiffn <span class="s2">"git diff --name-status"</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org3a50296">
<h2 id="org3a50296">Pass</h2>
<div class="outline-text-2" id="text-org3a50296">
<p>For <a href="https://www.passwordstore.org/">pass</a> the password-manager. I was doing the pull and push commands but decided to use the git <code>sync</code> alias which is actuall calling <code>legit sync</code>, which I think does pretty much the same as what I was doing. It does other stuff like stashing uncommitted changes, but that should never happen when using pass. Anyway. Sync.</p>
<div class="highlight">
<pre><span></span>abbr --add -- p <span class="s2">"pass"</span>
abbr --add -- pgs <span class="s2">"pass git sync"</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org8aebf46">
<h2 id="org8aebf46">Grep</h2>
<div class="outline-text-2" id="text-org8aebf46">
<div class="highlight">
<pre><span></span>abbr --add -- grepr <span class="s2">"grep --color=always"</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org313cde6">
<h2 id="org313cde6">Proton VPN</h2>
<div class="outline-text-2" id="text-org313cde6">
<div class="highlight">
<pre><span></span>abbr --add -- vdc <span class="s2">"protonvpn-cli disconnect; protonvpn-cli connect"</span>
</pre></div>
<div class="highlight">
<pre><span></span>abbr --add -- fastestvpn <span class="s2">"protonvpn-cli disconnect;protonvpn-cli connect --fastest; protonvpn-cli status"</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-orgc8dec2c">
<h2 id="orgc8dec2c">Rsync</h2>
<div class="outline-text-2" id="text-orgc8dec2c"></div>
<div class="outline-3" id="outline-container-org80ec003">
<h3 id="org80ec003">Rsyncer</h3>
<div class="outline-text-3" id="text-org80ec003">
<div class="highlight">
<pre><span></span>abbr --add -- rsyncer <span class="s2">"rsync --progress --archive --compress"</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org1a17ffd">
<h3 id="org1a17ffd">Rsyncerd</h3>
<div class="outline-text-3" id="text-org1a17ffd">
<div class="highlight">
<pre><span></span>abbr --add -- rsyncerd <span class="s2">"rsync --progress --archive --compress --delete"</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org1dd8fc9">
<h3 id="org1dd8fc9">Rsyncerf</h3>
<div class="outline-text-3" id="text-org1dd8fc9">
<p>Creates the folder structure but doesn't copy the files over.</p>
<div class="highlight">
<pre><span></span>abbr --add -- rsyncerf <span class="s1">'rsync --progress --archive --delete --include="*/" --exclude="*"'</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org820e092">
<h3 id="org820e092">Rsyncery</h3>
<div class="outline-text-3" id="text-org820e092">
<p>Does a dry-run to show what would be done without actually transferring files. I made this because for some reason the Raspeberry Pi with Debian 11 on it has some kind of bug that makes rsync fail if the transfers take too long. I don't really know the cause, but it doesn't happen with newer ubuntu versions so it seem like either it's a bug in the creation of the LUKs drive (since I'm creating it on the Raspberry Pi) or in the running of rsync (when the error actually occurs), but in either case, I sometimes need to do sub-folders one at a time instead of just syncing the top folder in order to keep the transfers shorter and running this lets me see what folders need to be synced.</p>
<div class="highlight">
<pre><span></span>abbr --add -- drysync <span class="s2">"rsync --verbose --archive --delete --dry-run"</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgae62230">
<h2 id="orgae62230">PDFs</h2>
<div class="outline-text-2" id="text-orgae62230"></div>
<div class="outline-3" id="outline-container-orgd6f0b27">
<h3 id="orgd6f0b27">PDF Join</h3>
<div class="outline-text-3" id="text-orgd6f0b27">
<p>Uses Ghostscript to join separate PDF files. Need to pass in the name for the output file and a list of files to be joined (likely using a glob).</p>
<div class="highlight">
<pre><span></span>abbr --add -- pdfjoin <span class="s2">"gs -dBATCH -dNOPAUSE -q -sDEVICE=pdfwrite -dPDFSETTINGS=/prepress -sOutputFile="</span>
</pre></div>
<p>Taken from <a href="https://stackoverflow.com/a/19358402">this answer</a> on Stack Overflow.</p>
<p>That answer also has some options to shrink the output PDF, but this is initially being tested on an alread shrunken PDF which either only got a little smaller, or even got a little bigger, when the lowere-resolution settings were used so I won't put it in until there comes a case where it's shown to help.</p>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org895e676">
<h2 id="org895e676">Links</h2>
<div class="outline-text-2" id="text-org895e676">
<ul class="org-ul">
<li>abbr - manage fish abbreviations — fish-shell 3.6.1 documentation [Internet]. [cited 2023 Jun 22]. Available from: <a href="https://fishshell.com/docs/current/cmds/abbr.html">https://fishshell.com/docs/current/cmds/abbr.html</a></li>
<li>faho. Answer to “Fish shell; import config into main config” [Internet]. Stack Overflow. 2018 [cited 2023 Jun 23]. Available from: <a href="https://stackoverflow.com/a/48749763">https://stackoverflow.com/a/48749763</a></li>
<li>Document conf.d / config.fish sourcing order · Issue #3099 · fish-shell/fish-shell [Internet]. GitHub. [cited 2023 Jun 23]. Available from: <a href="https://github.com/fish-shell/fish-shell/issues/3099">https://github.com/fish-shell/fish-shell/issues/3099</a></li>
<li><a href="https://askubuntu.com/questions/609303/how-can-i-view-a-progress-bar-when-running-rsync">Stack Exchange</a>: Rsync progress information</li>
</ul>
</div>
<div class="outline-3" id="outline-container-org3e61267">
<h3 id="org3e61267">Rsync</h3>
<div class="outline-text-3" id="text-org3e61267">
<ul class="org-ul">
<li><a href="https://serverfault.com/a/141778">Server Fault</a>: Answer explaining the <code>--archive</code> option (I was using it before but also adding other flags that were redundant to it).</li>
<li><a href="https://serverfault.com/a/204320">Server Fault answer</a>: explaining how to create the folder structure but not copy the files.</li>
</ul>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="configfish-the-fish-configuration/index.html">config.fish The Fish Configuration</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="configfish-the-fish-configuration/index.html" rel="bookmark"><time class="published dt-published" datetime="2023-06-22T13:14:19-07:00" itemprop="datePublished" title="2023-06-22 13:14">2023-06-22 13:14</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="configfish-the-fish-configuration/index.html#org7b25fe6">Environment Variables</a>
<ul>
<li><a href="configfish-the-fish-configuration/index.html#org5c66ff1">Emacs</a></li>
<li><a href="configfish-the-fish-configuration/index.html#org52e5b6c">The Rest</a></li>
</ul>
</li>
<li><a href="configfish-the-fish-configuration/index.html#orgf7b4fd4">Proton VPN</a></li>
</ul>
</div>
</div>
<p>This is the fish configuration file. It goes into <code>~/.config/fish/config.fish</code>.</p>
<div class="outline-2" id="outline-container-org7b25fe6">
<h2 id="org7b25fe6">Environment Variables</h2>
<div class="outline-text-2" id="text-org7b25fe6">
<p>The <code>--export</code> flag exports the shell variable to child processes, making it an "environment variable".</p>
</div>
<div class="outline-3" id="outline-container-org5c66ff1">
<h3 id="org5c66ff1">Emacs</h3>
<div class="outline-text-3" id="text-org5c66ff1">
<p>Sets us up to use the emacs client as the default editor.</p>
<ul class="org-ul">
<li><code>--create-frame</code> tells emacs to create a new frame instead of continuing in the current one (if it's already open).</li>
<li><code>--alternate-editor</code>: what to fall back to if the emacs-client server isn't running.</li>
</ul>
<div class="highlight">
<pre><span></span><span class="k">set</span> --export ALTERNATE_EDITOR <span class="s2">""</span>
<span class="k">set</span> --export EDITOR <span class="s2">"emacsclient --create-frame"</span>
<span class="k">set</span> --export VISUAL <span class="s2">"emacsclient --create-frame --alternate-editor emacs"</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org52e5b6c">
<h3 id="org52e5b6c">The Rest</h3>
<div class="outline-text-3" id="text-org52e5b6c">
<div class="highlight">
<pre><span></span><span class="c"># for extra docker build features (like smarter pip caching)</span>
<span class="k">set</span> --export DOCKER_BUILDKIT 1

<span class="c"># R Downloads</span>
<span class="k">set</span> --export R_LIBS ~/.local/lib/R/library/
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgf7b4fd4">
<h2 id="orgf7b4fd4">Proton VPN</h2>
<div class="outline-text-2" id="text-orgf7b4fd4">
<p>The current command-line interface is deprecated so it gets uninstalled when you install the GUI, but the GUI was having problems so I uninstalled it and went back to using the CLI, but depending on what is installed this may or may not work (and it is kind of slow so it may not be a good idea anyway). Everytime you open a shell this will run (e.g. a byobu window or SSH session).</p>
<div class="highlight">
<pre><span></span><span class="c"># check the vpn (requires the installation of the proton-vpn command-line command)</span>
<span class="k">if</span> <span class="nb">status</span> --is-interactive
  protonvpn-cli <span class="nb">status</span>
<span class="k">end</span>
</pre></div>
<div class="notecard" id="org2f42c17">
<p>I went back to using the GUI to test some things out… hopefully they'll get the CLI working again, but for now (2024-12-29) no CLI.</p>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="rst2org-function/index.html">rst2org Function</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="rst2org-function/index.html" rel="bookmark"><time class="published dt-published" datetime="2023-06-22T12:51:54-07:00" itemprop="datePublished" title="2023-06-22 12:51">2023-06-22 12:51</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div class="highlight">
<pre><span></span><span class="k">function</span> rst2org -d <span class="s2">"Convert text file to org"</span> --argument-names sourcefile
    <span class="k">set</span> target <span class="nv">$(</span>path change-extension org <span class="nv">$sourcefile</span><span class="o">)</span>
    pandoc --standalone <span class="nv">$sourcefile</span> --output <span class="nv">$target</span> --wrap<span class="o">=</span>none
<span class="k">end</span>
</pre></div>
<p>This function will convert a text file to an org file using pandoc. I called it <code>rst2org</code> because I created it specifically to convert restructured text, but since pandoc can infer it from the file extension it can be any input type that pandoc recognizes, I suppose.</p>
<div class="outline-2" id="outline-container-orgecc729a">
<h2 id="orgecc729a">What It's Doing</h2>
<div class="outline-text-2" id="text-orgecc729a">
<p>The first thing the function does is change the file extension from whatever it is to "org". So whatever gets passed in as the argument should have an extension like ".rst". Then it runs pandoc.</p>
<ul class="org-ul">
<li><code>--standalone</code>: by default pandoc strips out the header and footer, this option tells it to keep it (useful for nikola and most other thing I would imagine)</li>
<li><code>--output</code>: The output file name which pandoc also uses to guess the format we want to use.</li>
<li><code>--wrap=none</code>: by default pandoc will insert line-breaks to keep the lines within their default width, adding this argument keeps long lines as single lines.</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org59dedf4">
<h2 id="org59dedf4">Links</h2>
<div class="outline-text-2" id="text-org59dedf4">
<ul class="org-ul">
<li>mb21. Answer to “Word to Markdown via pandoc: prevent line breaks in paragraphs” [Internet]. Stack Overflow. 2020 [cited 2023 Jun 22]. Available from: <a href="https://stackoverflow.com/a/62990248">https://stackoverflow.com/a/62990248</a></li>
</ul>
<p>The first option documented in the options section of the pandoc documentation is <code>--from</code> which then lists all the languages that pandoc can take as an input.</p>
<ul class="org-ul">
<li>pandoc general options [Internet]. Available from <a href="https://pandoc.org/MANUAL.html#general-options">https://pandoc.org/MANUAL.html#general-options</a></li>
</ul>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="las-colored-list-all/index.html">las: Colored List All</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="las-colored-list-all/index.html" rel="bookmark"><time class="published dt-published" datetime="2023-06-22T12:10:57-07:00" itemprop="datePublished" title="2023-06-22 12:10">2023-06-22 12:10</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div class="highlight">
<pre><span></span><span class="k">function</span> las
    ls --almost-all <span class="se">\</span>
       --color <span class="se">\</span>
       --dereference-command-line <span class="se">\</span>
       --human-readable <span class="se">\</span>
       -l <span class="nv">$argv</span> <span class="o">|</span> <span class="se">\</span>
        less --RAW-CONTROL-CHARS
<span class="k">end</span>
</pre></div>
<p>The point of this function is to show all the files in the directory (including hidden files) and pipe them to <code>less</code> so they won't go scrolling off the screen while keeping the color highlighting.</p>
<div class="outline-2" id="outline-container-org6d179f6">
<h2 id="org6d179f6">The Parts</h2>
<div class="outline-text-2" id="text-org6d179f6"></div>
<div class="outline-3" id="outline-container-orgc3d6bfa">
<h3 id="orgc3d6bfa">The <code>ls</code> Arguments</h3>
<div class="outline-text-3" id="text-orgc3d6bfa">
<ul class="org-ul">
<li><code>--almost-all</code>: don't list the <code>.</code> and <code>..</code> files</li>
<li><code>--color</code>: Color the output when (defaults to "always" but you can set to "auto" or "never")</li>
<li><code>--dereference-command-line</code>: follow symbolic links listed on the command line</li>
<li><code>--human-readable</code>: Put file sizes into units that make sense (when using <code>-l</code>)</li>
<li><code>-l</code>: Long listing format.</li>
</ul>
</div>
</div>
<div class="outline-3" id="outline-container-org02d0fd5">
<h3 id="org02d0fd5">The <code>less</code> Argument</h3>
<div class="outline-text-3" id="text-org02d0fd5">
<ul class="org-ul">
<li><code>--RAW-CONTROL-CHARS</code>: Keep colors and hyperlink sequences.</li>
</ul>
<div class="notecard" id="org89cd72e">
<p>There is also a <code>--raw-control-chars</code> option which will include all escape sequences, but they say this might cause less to not be able to control the appearance of the screen so they don't recommend using it. Also, you can set the <code>LESS</code> environment variable to pass in options, so if this is useful enough it might make sense to put it in there instead.</p>
</div>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="choose-function/index.html">Choose Function</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="choose-function/index.html" rel="bookmark"><time class="published dt-published" datetime="2023-06-07T11:30:31-07:00" itemprop="datePublished" title="2023-06-07 11:30">2023-06-07 11:30</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div class="outline-2" id="outline-container-org5d00af4">
<h2 id="org5d00af4">Choose</h2>
<div class="outline-text-2" id="text-org5d00af4">
<p>An alias function that will pick a random line (or lines) out of a text file.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org601550a">
<h2 id="org601550a">The Function Declaration</h2>
<div class="outline-text-2" id="text-org601550a">
<p>Our alias function (<code>choose</code>) takes one required argument that we'll assign to the variable <code>filename</code> and one optional argument <code>lines</code> to indicate the number of lines to pull.</p>
<div class="highlight">
<pre><span></span><span class="k">function</span> choose -d <span class="s2">"Random line from a file."</span> --argument-names filename lines
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-orgc49440f">
<h2 id="orgc49440f">The Error String</h2>
<div class="outline-text-2" id="text-orgc49440f">
<p>I'm setting a string-format variable that I'll use to color error messages in bold red.</p>
<div class="highlight">
<pre><span></span><span class="k">set</span> ERROR <span class="s2">"\x1b[31;1m\t%s\n\n\x1b[0m"</span>
</pre></div>
<p>See <a href="https://stackoverflow.com/a/33206814">this stack overflow answer</a> for more explanation of the codes. Basically the <code>31;1m</code> part turns on red (31) and bold (1) and <code>0m</code> resets it back to unbolded black text.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgd444c7f">
<h2 id="orgd444c7f">The Okay Variable</h2>
<div class="outline-text-2" id="text-orgd444c7f">
<p>This is getting a little convoluted but I added another check for the second argument to make sure it's a number so this flag is just there to indicate that it did or didn't look like right.</p>
<div class="highlight">
<pre><span></span><span class="k">set</span> OKAY 0
</pre></div>
<p>I'm setting it to False so that it has to pass the checks in order to be unset.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgde675b7">
<h2 id="orgde675b7">Check the Number of Lines</h2>
<div class="outline-text-2" id="text-orgde675b7">
<p>Unlike <code>random</code>, shuf will let you pick multiple lines so I added a second (optional) argument to indicate the number of lines to output. If none is passed in then it's set to one, if something other than an integer is passed in then we'll set a flag so we know to skip calling the <code>shuf</code> command later on.</p>
<ul class="org-ul">
<li><code>test -n "$lines"</code> will return True if <code>lines</code> is non-empty so I negated it with <code>!</code> to return True if it's empty.</li>
</ul>
<div class="highlight">
<pre><span></span><span class="k">if</span> ! <span class="k">test</span> -n <span class="s2">"</span><span class="nv">$lines</span><span class="s2">"</span>
  <span class="k">set</span> lines 1
  <span class="k">set</span> OKAY 1
<span class="k">else</span> <span class="k">if</span> ! <span class="k">test</span> <span class="o">(</span>string match --regex <span class="s2">"^[0-9]+\$"</span> <span class="nv">$lines</span><span class="o">)</span>
  <span class="k">set</span> OKAY 0
  <span class="nb">printf</span> <span class="nv">$ERROR</span> <span class="s2">"Not a valid number of lines: '</span><span class="nv">$lines</span><span class="s2">'"</span>
<span class="k">else</span>
  <span class="k">set</span> OKAY 1
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org5f4359f">
<h2 id="org5f4359f">If It's a Text File, Use It</h2>
<div class="outline-text-2" id="text-org5f4359f">
<p>We'll be grabbing a line using the <a href="https://man7.org/linux/man-pages/man1/shuf.1.html">shuf</a> command. <code>shuf</code> will hang if no filename is given and it will try and read binary files so first we have to test the filename to make sure it's a text file.</p>
<p>To do the check I'm using the <a href="https://www.man7.org/linux/man-pages/man1/file.1.html"><code>file</code></a> command which will have the word "text" in the output if we give it a text file. Then I feed the output from <code>file</code> to the <code>string match</code> command. This command defaults to only return true if the whole string matches so I added a glob to both ends of the "text" string to match any string that contains it. So, in order to pass the test <code>filename</code> has to have the name of a text file or we won't match the output of the <code>file</code> command.</p>
<p>First, though, we check if the <code>lines</code> argument was okay and if it was and <code>filename</code> passes its test then we can feed it to <code>shuf</code>.</p>
<div class="highlight">
<pre><span></span><span class="k">if</span> <span class="k">test</span> <span class="nv">$OKAY</span> -ne 0<span class="p">;</span> <span class="k">and</span> <span class="k">test</span> <span class="o">(</span>string match <span class="s2">"*text*"</span> <span class="o">(</span>file <span class="s2">"</span><span class="nv">$filename</span><span class="s2">"</span><span class="o">))</span>
   shuf -n <span class="nv">$lines</span> <span class="nv">$filename</span>
</pre></div>
<ul class="org-ul">
<li><code>test $OKAY -ne 0</code> will return True if OKAY != 0. It will return an error if OKAY holds something other than a number.</li>
<li>the <code>; and</code> syntax is a short-circuit syntax that won't run the second test if the first one fails.</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org68e0f07">
<h2 id="org68e0f07">Handle the Errors</h2>
<div class="outline-text-2" id="text-org68e0f07">
<p>If the number of lines wasn't okay or the filename wasn't valid then we'll emit a help message. Since we emitted any error message about the number</p>
<div class="highlight">
<pre><span></span><span class="k">else</span>
  <span class="k">if</span> ! <span class="k">test</span> -n <span class="s2">"</span><span class="nv">$filename</span><span class="s2">"</span>
    <span class="nb">printf</span> <span class="nv">$ERROR</span>  <span class="s2">"**Missing Filename**"</span>
  <span class="k">else</span> <span class="k">if</span> <span class="k">test</span> <span class="nv">$OKAY</span> -ne 0
    <span class="nb">printf</span> <span class="nv">$ERROR</span> <span class="s2">"Invalid File: '</span><span class="nv">$filename</span><span class="s2">'"</span>
  <span class="k">end</span>
  <span class="k">set</span> OKAY 0
<span class="k">end</span> <span class="c"># check filename</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org34c0d10">
<h2 id="org34c0d10">Emit a Help Message</h2>
<div class="outline-text-2" id="text-org34c0d10">
<p>If it had a valid number of lines and a valid filename then <code>OKAY</code> will have a value of 1, otherwise it will have a value of 0 and we'll emit the help message.</p>
<div class="highlight">
<pre><span></span><span class="k">if</span> <span class="k">test</span> <span class="nv">$OKAY</span> -eq <span class="m">0</span>     
  <span class="nb">printf</span> <span class="s2">"\t%s\n"</span> <span class="se">\</span>
         <span class="s2">"Output a random line or lines from a text file."</span> <span class="se">\ \</span>
         <span class="s2">"Usage:"</span> <span class="se">\ \</span>
         <span class="s2">"    choose &lt;filename&gt; [&lt;number of lines&gt;]"</span>
<span class="k">end</span> <span class="c"># help message</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org1e80cbc">
<h2 id="org1e80cbc">One Last Thing</h2>
<div class="outline-text-2" id="text-org1e80cbc">
<p>If the user passes in a flag as a filename this will get passed to the <code>file</code> command and in some cases this will cause it to emit a help message which will get passed to the <code>shuf</code> command. It's probably not a good idea to let that happen, but this was only supposed to be an alias so I wouldn't have to remember the syntax for <code>shuf</code>, so hopefully it'll work okay.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgaecba27">
<h2 id="orgaecba27">Sources</h2>
<div class="outline-text-2" id="text-orgaecba27">
<ul class="org-ul">
<li>string-match - match substrings — fish-shell 3.6.1 documentation [Internet]. [cited 2023 Jun 7]. Available from: <a href="https://fishshell.com/docs/current/cmds/string-match.html">https://fishshell.com/docs/current/cmds/string-match.html</a></li>
<li>test - perform tests on files and text — fish-shell 3.6.1 documentation [Internet]. [cited 2023 Jun 7]. Available from: <a href="https://fishshell.com/docs/current/cmds/test.html">https://fishshell.com/docs/current/cmds/test.html</a></li>
<li>shuf(1) - Linux manual page [Internet]. [cited 2023 Jun 7]. Available from: <a href="https://man7.org/linux/man-pages/man1/shuf.1.html">https://man7.org/linux/man-pages/man1/shuf.1.html</a></li>
<li>file(1) - Linux manual page [Internet]. [cited 2023 Jun 7]. Available from: <a href="https://www.man7.org/linux/man-pages/man1/file.1.html">https://www.man7.org/linux/man-pages/man1/file.1.html</a></li>
</ul>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="random-hex/index.html">Random Hex</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="random-hex/index.html" rel="bookmark"><time class="published dt-published" datetime="2023-06-05T17:30:53-07:00" itemprop="datePublished" title="2023-06-05 17:30">2023-06-05 17:30</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="random-hex/index.html#orgb7a392c">The randomdhex Function</a></li>
<li><a href="random-hex/index.html#org89170f6">The Function Header</a></li>
<li><a href="random-hex/index.html#org436a99b">Argument Check</a>
<ul>
<li><a href="random-hex/index.html#orgbda9072">Check For An Argument</a></li>
<li><a href="random-hex/index.html#org259a0af">Check If The Argument Is An Integer</a></li>
<li><a href="random-hex/index.html#org26d97f8">Set the Argument Value</a></li>
<li><a href="random-hex/index.html#orgbf0cd53">Error Message</a></li>
<li><a href="random-hex/index.html#org899003c">Use The Default</a></li>
</ul>
</li>
<li><a href="random-hex/index.html#orgf713798">Output the Random Hexadecimal</a></li>
<li><a href="random-hex/index.html#org067ad07">Sources</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orgb7a392c">
<h2 id="orgb7a392c">The randomdhex Function</h2>
<div class="outline-text-2" id="text-orgb7a392c">
<p>This an alias function to output a random hexadecimal number. There are many ways to do this but I took this from <a href="https://stackoverflow.com/a/53668354">a StackOverFlow answer</a>.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org89170f6">
<h2 id="org89170f6">The Function Header</h2>
<div class="outline-text-2" id="text-org89170f6">
<p>I'm going to create a function named <code>randomhex</code> that takes one optional argument named <code>digits</code>.</p>
<div class="highlight">
<pre><span></span><span class="k">function</span> randomhex -d <span class="s2">"random hex string"</span> --argument-names digits
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org436a99b">
<h2 id="org436a99b">Argument Check</h2>
<div class="outline-text-2" id="text-org436a99b">
<p>The first thing to do is to check if the user passed in an argument and handle it if they did or use a default if they didn't.</p>
</div>
<div class="outline-3" id="outline-container-orgbda9072">
<h3 id="orgbda9072">Check For An Argument</h3>
<div class="outline-text-3" id="text-orgbda9072">
<p>The first check uses the <a href="https://fishshell.com/docs/current/cmds/test.html">test</a> command to see if the user passed in an argument. the <code>-n</code> flag tells it to check if there's a string with one or more characters in it in our <code>digits</code> variable.</p>
<div class="highlight">
<pre><span></span><span class="k">if</span> <span class="k">test</span> -n <span class="s2">"</span><span class="nv">$digits</span><span class="s2">"</span> <span class="c"># then an argument was passed in</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org259a0af">
<h3 id="org259a0af">Check If The Argument Is An Integer</h3>
<div class="outline-text-3" id="text-org259a0af">
<p>If the user <i>did</i> pass in an argument but it can't be coerced to be an integer then our function won't work right so we need to see if the argument is made up of nothing but digits using the <a href="https://fishshell.com/docs/current/cmds/string-match.html">string match</a> command and a regular expression to make sure it's only made up of one or more digits.</p>
<div class="highlight">
<pre><span></span><span class="k">if</span> <span class="k">test</span> <span class="o">(</span>string match --regex <span class="s2">"^[0-9]+\$"</span> <span class="nv">$digits</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org26d97f8">
<h3 id="org26d97f8">Set the Argument Value</h3>
<div class="outline-text-3" id="text-org26d97f8">
<p>If the argument was an integer then we'll set the <code>BYTES</code> variable to half of whatever the user passed in, because each byte is represented by two hexadecimal digits (8 bits gives values from 0 to 255 in decimal, 00 to FF in hexadecimal). The argument is a string so we need to pass our division expression (<code>$digits/2</code>) to the <code>math</code> command in order for it to be evaluated as a number. Additionally, the division operator will return a float if the user's input isn't evenly divisible so I'll use the <code>ceil</code> argument to round up to the nearest integer.</p>
<div class="highlight">
<pre><span></span><span class="k">set</span> BYTES <span class="nv">$(</span><span class="nb">math </span>ceil <span class="nv">$digits</span>/2<span class="o">)</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgbf0cd53">
<h3 id="orgbf0cd53">Error Message</h3>
<div class="outline-text-3" id="text-orgbf0cd53">
<p>If the user passed in an argument but it doesn't look like an integer then we'll output a help message. I got the idea of using <code>printf</code> this way from <a href="https://stackoverflow.com/a/48249785">this StackOverflow answer</a>.</p>
<ul class="org-ul">
<li>Each line after the first gets passend into the first string, substituted where <code>%s</code> is</li>
<li>One backslash continues the input</li>
<li>Two backslashes with a space in-between them will insert an extra line and continue the input</li>
<li>The space between the backslashes is important - fish will throw an error if you put <code>\\</code> instead of <code>\ \</code></li>
</ul>
<div class="highlight">
<pre><span></span><span class="k">else</span> <span class="c"># the argument isn't an integer</span>
  <span class="nb">printf</span> <span class="s2">"\t%s\n"</span> <span class="se">\</span>
   <span class="s2">"Output a random hexadecimal number"</span> <span class="se">\ \</span>
   <span class="s2">"Usage:"</span> <span class="se">\ \</span>
   <span class="s2">"randomhex &lt;digits&gt;"</span> <span class="se">\ \</span>
   <span class="s2">"Optional argument:"</span> <span class="se">\</span>
   <span class="s2">" - Number of digits (will round up to even number)"</span> <span class="se">\</span>
   <span class="s2">"   Argument must be an integer (default=8)."</span>
   <span class="k">return</span>
<span class="k">end</span> <span class="c"># if is-integer check</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org899003c">
<h3 id="org899003c">Use The Default</h3>
<div class="outline-text-3" id="text-org899003c">
<p>If the user didn't pass in an argument then use a default of 8 hexadecimal digits.</p>
<div class="highlight">
<pre><span></span><span class="k">else</span> <span class="c"># Set our bytes so we have 8 digits (double the bytes)</span>
  <span class="k">set</span> BYTES 4
<span class="k">end</span> <span class="c"># setting the number of bytes</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgf713798">
<h2 id="orgf713798">Output the Random Hexadecimal</h2>
<div class="outline-text-2" id="text-orgf713798">
<p>Finally we output the random hexadecimal number that <a href="https://www.openssl.org/"><code>openssl</code></a> generates.</p>
<div class="highlight">
<pre><span></span><span class="k">echo</span> <span class="nv">$(</span>openssl rand -hex <span class="nv">$BYTES</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org067ad07">
<h2 id="org067ad07">Sources</h2>
<div class="outline-text-2" id="text-org067ad07">
<ul class="org-ul">
<li>OpenSSL rand [Internet]. [cited 2023 Jun 5]. Available from: <a href="https://www.openssl.org/docs/man1.1.1/man1/rand.html">https://www.openssl.org/docs/man1.1.1/man1/rand.html</a></li>
<li>How to get a random string of 32 hexadecimal digits through command line? [Internet]. Stack Overflow. 2015 [cited 2023 Jun 5]. Available from: <a href="https://stackoverflow.com/q/34328759">https://stackoverflow.com/q/34328759</a></li>
</ul>
</div>
</div>
</div>
</article>
</div>
<ul class="pager postindexpager clearfix">
<li class="previous"><a href="index.html" rel="prev">Newer posts</a></li>
</ul>
<!--End of body content-->
<footer id="footer">Scribbled by the <a href="mailto:cloisteredmonkey.jmark@slmail.me">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a>
<div id="license" xmlns:cc="http://creativecommons.org/ns#">This work is licensed under <a href="http://creativecommons.org/licenses/by/4.0/?ref=chooser-v1" rel="license noopener noreferrer" style="display:inline-block;" target="_blank">CC BY 4.0 <img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"></a></div>
</footer>
</div>
</div>
<script src="../assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
</script>
</body>
</html>
