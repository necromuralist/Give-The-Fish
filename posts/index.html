<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="The functions of a fish." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Give the Fish</title>
<link href="../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../rss.xml" hreflang="en" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/Give-The-Fish/posts/index.html" rel="canonical">
<link href="index-2.html" rel="next" type="text/html"><!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]--><!-- favicons -->
<link href="../apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="../android-chrome-192x192.png" rel="android-chrome-icon" sizes="192x192">
<link href="../android-chrome-512x512.png" rel="android-chrome-icon" sizes="512x512">
<link href="../favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="../favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="../site.webmanifest" rel="manifest">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="../"><span id="blog-title">Give the Fish</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href=".">Posts</a></li>
<li class="nav-item"><a class="nav-link" href="../archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="../categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="../rss.xml">RSS feed</a></li>
<li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Monkey Sites</a>
<div class="dropdown-menu"><a class="dropdown-item" href="https://necromuralist.github.io/">The Cloistered Monkey</a> <a class="dropdown-item" href="https://necromuralist.github.io/Ape-Iron/">Ape Iron</a> <a class="dropdown-item" href="https://necromuralist.github.io/Beach-Pig-Thigh/">Beach Pig Runp & Thigh</a> <a class="dropdown-item" href="https://necromuralist.github.io/Bowling-For-Data/">Bowling For Data</a> <a class="dropdown-item" href="https://necromuralist.github.io/Neurotic-Networking/">Neurotic Networking</a> <a class="dropdown-item" href="https://necromuralist.github.io/Terribilis-Ludum/">Terribilis Ludum</a> <a class="dropdown-item" href="https://necromuralist.github.io/Visions-Voices-Data/">Visions, Voices, Data</a></div>
</li>
</ul>
<!-- DuckDuckGo custom search -->
<form action="https://duckduckgo.com/" class="navbar-form pull-left" id="search" method="get" name="search"><input name="sites" type="hidden" value="https://necromuralist.github.io/Give-The-Fish/"><input name="k8" type="hidden" value="#444444"><input name="k9" type="hidden" value="#D51920"><input name="kt" type="hidden" value="h"><input class="span2" maxlength="255" name="q" placeholder="Search…" type="text"><input style="visibility: hidden;display:none" type="submit" value="DuckDuckGo Search"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<div class="postindex">
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="upgrade-function/index.html">Upgrade Function</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="upgrade-function/index.html" rel="bookmark"><time class="published dt-published" datetime="2025-06-24T12:04:29-07:00" itemprop="datePublished" title="2025-06-24 12:04">2025-06-24 12:04</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="upgrade-function/index.html#orgeb1a962">The Function</a>
<ul>
<li><a href="upgrade-function/index.html#org102a4c6">Bold Blue</a></li>
<li><a href="upgrade-function/index.html#orge3e710d">Apt Calls</a></li>
<li><a href="upgrade-function/index.html#org32fb363">Snap</a></li>
<li><a href="upgrade-function/index.html#orgfa0829b">Flatpak</a></li>
<li><a href="upgrade-function/index.html#orga408d75">Uninstall</a></li>
</ul>
</li>
<li><a href="upgrade-function/index.html#orga1da25c">Some Messages</a>
<ul>
<li><a href="upgrade-function/index.html#org904f869">Phased Updates</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-orgeb1a962">
<h2 id="orgeb1a962">The Function</h2>
<div class="outline-text-2" id="text-orgeb1a962">
<p>This is a function to upgrade the various packages. It might, perhaps be better as an abbreviation…</p>
<div class="highlight">
<pre><span></span><span class="k">function</span> upgrade --description <span class="s2">"Upgrade packages."</span>
</pre></div>
</div>
<div class="outline-3" id="outline-container-org102a4c6">
<h3 id="org102a4c6">Bold Blue</h3>
<div class="outline-text-3" id="text-org102a4c6">
<p>This is a helper function to set lines (specifically headlines in this case) to be bold and blue. If this gets done enough maybe it should be a standalone function, but for now it's embedded in the <code>upgrade</code> function.</p>
<div class="highlight">
<pre><span></span><span class="k">function</span> boldblue
    <span class="nb">set_color</span> --bold blue
    <span class="k">echo</span> <span class="nv">$argv</span>
    <span class="nb">set_color </span>normal
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orge3e710d">
<h3 id="orge3e710d">Apt Calls</h3>
<div class="outline-text-3" id="text-orge3e710d">
<p>These are calls to update the debian-based packages.</p>
</div>
<div class="outline-4" id="outline-container-org613a01c">
<h4 id="org613a01c">Update</h4>
<div class="outline-text-4" id="text-org613a01c">
<p>These calls update the database and then show us what is upgradable.</p>
<div class="highlight">
<pre><span></span>boldblue Checking apt
sudo apt-fast update --yes
sudo apt-get --just-print upgrade
</pre></div>
<div class="notecard" id="orgd3bd8e3">
<p>I was initially using <code>apt</code> to list the upgradable packages, but installing <code>more</code> as a pager causes its output to get piped to it, stopping progress until I quit it. Looking into how to get around it I read that <code>apt</code> is a front-end to other packages to make them easier to use, and that <code>apt-get</code> is better for non-interactive use (and is one of the things that <code>apt</code> is using behind the scenes anyway).</p>
</div>
</div>
</div>
<div class="outline-4" id="outline-container-org127b823">
<h4 id="org127b823">Upgrade and Autoremove</h4>
<div class="outline-text-4" id="text-org127b823">
<p>Now we run the upgrade. <code>upgrade</code> will upgrade installed packages and install any dependencies that are needed, but not uninstall any already installed packages. If upgrading needs to a removal it won't do the upgrade. <code>full-upgrade</code> will do what <code>upgrade</code> does but will remove any installed packages if needed to upgrade an installed package. So, we're going with <code>full-upgrade</code>.</p>
<p>I'm also auto-removing any packages that get orphaned as dependencies by an upgrade.</p>
<div class="highlight">
<pre><span></span>boldblue Upgrading apt
sudo apt-fast full-upgrade --yes
sudo apt-get autoremove --yes
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org32fb363">
<h3 id="org32fb363">Snap</h3>
<div class="outline-text-3" id="text-org32fb363">
<p>Snaps should update themselves. But let's see what happens if we do it.</p>
<div class="highlight">
<pre><span></span>boldblue Updating snaps
sudo snap refresh
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgfa0829b">
<h3 id="orgfa0829b">Flatpak</h3>
<div class="outline-text-3" id="text-orgfa0829b"></div>
<div class="outline-4" id="outline-container-org377941a">
<h4 id="org377941a">Update</h4>
<div class="outline-text-4" id="text-org377941a">
<div class="highlight">
<pre><span></span>boldblue Updating flatpak
flatpak update --assumeyes
</pre></div>
<div class="notecard" id="org4d743ac">
<p><b>Note:</b> I was running this with <code>--noninteractive</code> but for some reason this still emitted messages that something needed to be fixed but suppressed the message telling me which package needed to be fixed, so it seems better not to use that option.</p>
</div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orga408d75">
<h3 id="orga408d75">Uninstall</h3>
<div class="outline-text-3" id="text-orga408d75">
<div class="highlight">
<pre><span></span>boldblue Uninstalling unused flatpaks
flatpak uninstall --unused --assumeyes
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orga1da25c">
<h2 id="orga1da25c">Some Messages</h2>
<div class="outline-text-2" id="text-orga1da25c"></div>
<div class="outline-3" id="outline-container-org904f869">
<h3 id="org904f869">Phased Updates</h3>
<div class="outline-text-3" id="text-org904f869">
<div class="highlight">
<pre><span></span>The following upgrades have been deferred due to phasing:
  alsa-ucm-conf
</pre></div>
<p>This message is referring to <a href="https://documentation.ubuntu.com/server/explanation/software/about-apt-upgrade-and-phased-updates/">Phased Updating</a>. That is, there is an update that is being rolled out in stages to see if it is stable before it's given out to everybody. So the update exists, but you won't get it until the developers decide it's okay to roll it out to everybody.</p>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="tealdeer-pages/index.html">Tealdeer Pages</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="tealdeer-pages/index.html" rel="bookmark"><time class="published dt-published" datetime="2025-05-30T11:43:01-07:00" itemprop="datePublished" title="2025-05-30 11:43">2025-05-30 11:43</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="tealdeer-pages/index.html#org7a81e08">Patches</a>
<ul>
<li><a href="tealdeer-pages/index.html#org4852195">Screen</a></li>
<li><a href="tealdeer-pages/index.html#org073df01">Ghostscript (gs)</a></li>
<li><a href="tealdeer-pages/index.html#org2bcabd9">Virtual Fish</a></li>
<li><a href="tealdeer-pages/index.html#org57cffff">pdfjam</a></li>
<li><a href="tealdeer-pages/index.html#orga8043d6">Emacs</a></li>
<li><a href="tealdeer-pages/index.html#org51367b7">Image Magick</a></li>
<li><a href="tealdeer-pages/index.html#org75d8d60">PDF TK</a></li>
</ul>
</li>
<li><a href="tealdeer-pages/index.html#org65e2b58">Pages</a>
<ul>
<li><a href="tealdeer-pages/index.html#orgf3594ef">MakeMKV Command Line</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>This is for configuring <a href="https://tealdeer-rs.github.io/tealdeer/">tealdeer</a>, a command-line help system.</p>
<ul class="org-ul">
<li>The expected folder in this repository to put these pages is <code>dingehaufen/tealdeer/pages/</code>.</li>
<li>The default location that <code>tealdeer</code> will look for the pages is \(~/.local/share/tealdeer/pages/~\) so maybe symlink it there.</li>
<li>The pages that come with <code>tealdeer</code> are at \(~/.cache/tealdeer/tldr-pages/pages/\) (look here for examples)</li>
</ul>
<div class="outline-2" id="outline-container-org7a81e08">
<h2 id="org7a81e08">Patches</h2>
<div class="outline-text-2" id="text-org7a81e08">
<p>These are <a href="https://tealdeer-rs.github.io/tealdeer/usage_custom_pages.html#custom-patches">patches</a> which extend existing help pages rather than replacing them. If you want to add a new command or replace the existing tealdeer help you would use <a href="https://tealdeer-rs.github.io/tealdeer/usage_custom_pages.html#custom-pages">pages</a> instead (they go in the same folder, there's just a different file-name convention).</p>
</div>
<div class="outline-3" id="outline-container-org4852195">
<h3 id="org4852195">Screen</h3>
<div class="outline-text-3" id="text-org4852195"></div>
<div class="outline-4" id="outline-container-org8b6822a">
<h4 id="org8b6822a">Name the Screen</h4>
<div class="outline-text-4" id="text-org8b6822a">
<div class="highlight">
<pre><span></span>- Give the screen a name

`&lt;Ctrl-a&gt; A`
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org073df01">
<h3 id="org073df01">Ghostscript (gs)</h3>
<div class="outline-text-3" id="text-org073df01">
<p>This is for ghost script.</p>
</div>
<div class="outline-4" id="outline-container-orgf869ba1">
<h4 id="orgf869ba1">Black and White PDF</h4>
<div class="outline-text-4" id="text-orgf869ba1">
<p>This is to convert a PDF's text and vector images to Black and White to make it easier to read when printed. From a <a href="https://askubuntu.com/a/1474303">Ask Ubunt (Stack Exchange)</a> answer.</p>
<div class="notecard" id="org166daa7">
<p>In the cases I've tried this doesn't convert raster images.</p>
</div>
<div class="highlight">
<pre><span></span><span class="k">-</span><span class="w"> </span>Convert PDF text to black and white (not grayscale)

<span class="sb">`gs -sDEVICE=pdfwrite -dBlackText -dBlackVector -dNOPAUSE -dBATCH -sOutputFile={{output-file-name}} {{pdf-input-file-name}}`</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org60fcb4f">
<h4 id="org60fcb4f">Compress For Ebook</h4>
<div class="outline-text-4" id="text-org60fcb4f">
<p>This adds some extra flags to the compression help that comes with tealdeer.</p>
<div class="highlight">
<pre><span></span><span class="k">-</span><span class="w"> </span>Reduce PDF File Size, possibly more than the version up above

<span class="sb">`gs -sDEVICE=pdfwrite -dCompatibilityLevel=1.4 -dPDFSETTINGS=/ebook -dNOPAUSE -dQUIET -dBATCH -dDetectDuplicateImages -dCompressFonts=true -sOutputFile={{output-file-name}} {{input-file-name}}`</span>
</pre></div>
<ul class="org-ul">
<li>See : <a href="https://ghostscript.com/blog/optimizing-pdfs.html">Optimizing PDFs</a> - From the Ghostscript Blog. This notes that DetectDuplicateImages is actually on by default so you only need to use it if you want to turn it off, but I didn't read that until after using it. It might make sense to experiment with it on and off. The same might go for the CompatibilityLevel.</li>
</ul>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org2bcabd9">
<h3 id="org2bcabd9">Virtual Fish</h3>
<div class="outline-text-3" id="text-org2bcabd9"></div>
<div class="outline-4" id="outline-container-orgf991f6f">
<h4 id="orgf991f6f">Check The Environment</h4>
<div class="outline-text-4" id="text-orgf991f6f">
<p>This adds the build-state for the virtual-environments managed by virtualfish.</p>
<div class="highlight">
<pre><span></span><span class="k">-</span><span class="w"> </span>List Environments and the Current State (do they need to be rebuilt?):

<span class="sb">`vf ls --details`</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org0735232">
<h4 id="org0735232">Rebuild the Environment</h4>
<div class="outline-text-4" id="text-org0735232">
<p>This is the command to use after an Ubuntu upgrade where they change the python version and all the virtual environments are broken.</p>
<div class="highlight">
<pre><span></span><span class="k">-</span><span class="w"> </span>Rebuild the current environment (e.g. after Ubuntu changes pip):

<span class="sb">`vf upgrade --rebuild`</span>
</pre></div>
<p>You can also rebuild a specific environment (not necessarily the one you're in).</p>
<div class="highlight">
<pre><span></span><span class="k">-</span><span class="w"> </span>Rebuild a specific environment

<span class="sb">`vf upgrade --rebuild {{virtualenv-name}}`</span>
</pre></div>
<div class="notecard" id="orga5cf7f9">
<p>If the environments are broken by an update, <code>pipx</code> is likely broken too, run this too, maybe:</p>
<ul class="org-ul">
<li><code>pipx reinstall-all</code></li>
<li><code>pip install setuptools --upgrade</code></li>
</ul>
</div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org57cffff">
<h3 id="org57cffff">pdfjam</h3>
<div class="outline-text-3" id="text-org57cffff"></div>
<div class="outline-4" id="outline-container-orgba356cd">
<h4 id="orgba356cd">Resize to Letter</h4>
<div class="outline-text-4" id="text-orgba356cd">
<div class="highlight">
<pre><span></span><span class="k">-</span><span class="w"> </span>Resize PDF document to letter-paper size

<span class="sb">`pdfjam {{input-file}} --paper letter --outfile {{output-file-name}}`</span>

<span class="sb">`pdfjam {{input-file}} --papersize 8.5in,11in --outfile {{output-file-name}}`</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-orga8043d6">
<h3 id="orga8043d6">Emacs</h3>
<div class="outline-text-3" id="text-orga8043d6"></div>
<div class="outline-4" id="outline-container-org77a0324">
<h4 id="org77a0324">Open File With Sudo</h4>
<div class="outline-text-4" id="text-org77a0324">
<p>Got this from <a href="https://stackoverflow.com/questions/95631/open-a-file-with-su-sudo-inside-emacs">a Stack Overflow Question</a>. The user's question is asking for an alternative way to do this, but the answers tell him that it's the best way to do it after all (he thought it was using SSH but it uses a sub-shell).</p>
<div class="highlight">
<pre><span></span><span class="k">-</span><span class="w"> </span>Open a (local) file with sudo.

<span class="sb">`C-x C-f /sudo::/path/to/file`</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org6fc24a7">
<h4 id="org6fc24a7">Use a Different Init.el</h4>
<div class="outline-text-4" id="text-org6fc24a7">
<p>This is to use a different <code>init.el</code> file (presumably for debugging).</p>
<div class="highlight">
<pre><span></span><span class="k">-</span><span class="w"> </span>Use a different initialization file when starting up:

<span class="sb">`emacs --init-directory={{path/to/directory-with-init/}}`</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org51367b7">
<h3 id="org51367b7">Image Magick</h3>
<div class="outline-text-3" id="text-org51367b7"></div>
<div class="outline-4" id="outline-container-org1cd0472">
<h4 id="org1cd0472">Remove PDF Background</h4>
<div class="outline-text-4" id="text-org1cd0472">
<p>This assumes a image "density" for the background and converts the pages to images so the output file will likely be much larger. It might be best to use this for printing and then deleting the converted PDF.</p>
<div class="highlight">
<pre><span></span><span class="k">-</span><span class="w"> </span>Remove background of PDF assuming the image density

<span class="sb">`magick convert -density 300 {{path/to/input.pdf}} -white-threshold 80% {{path/to/output.pdf}}`</span>
</pre></div>
<div class="notecard" id="org1184393">
<p>I also tried removing the background color specifically but doing that eats into everything that sits above the background as well (removes the anti-aliasing overlap, I assume).</p>
</div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org75d8d60">
<h3 id="org75d8d60">PDF TK</h3>
<div class="outline-text-3" id="text-org75d8d60"></div>
<div class="outline-4" id="outline-container-orgf549e1f">
<h4 id="orgf549e1f">Export Bookmarks</h4>
<div class="outline-text-4" id="text-orgf549e1f">
<p>Export bookmarks from a PDF. I normally use <code>cpdf</code> for bookmarks, but in the case of Wanderhome, when I reduced the resolution to get a smaller PDF it removed the bookmarks so I had to copy them from the original and for some reason <code>cpdf</code> couldn't dump them, but pdftk could.</p>
<p>Pdftk uses a human-readable format that isn't compatible with cpdf. For Example:</p>
<div class="highlight">
<pre><span></span>BookmarkBegin
BookmarkTitle: wanderhome.pdf
BookmarkLevel: 1
BookmarkPageNumber: 0
BookmarkBegin
BookmarkTitle: Copyright
BookmarkLevel: 2
BookmarkPageNumber: 0
BookmarkBegin
BookmarkTitle: Table of Contents
BookmarkLevel: 2
BookmarkPageNumber: 0
</pre></div>
<p>Taken from <a href="https://www.pdflabs.com/blog/export-and-import-pdf-bookmarks/">PDFLabs Export and Import PDF Bookmarks</a>.</p>
<div class="highlight">
<pre><span></span><span class="k">-</span><span class="w"> </span>Export existing bookmarks from a pdf (UTF-8 Version)

<span class="sb">`pdftk {{input.pdf}} dump_data_utf8 output {{bookmarks.txt}}`</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orge907293">
<h4 id="orge907293">Import Bookmarks</h4>
<div class="outline-text-4" id="text-orge907293">
<p>Import bookmarks dumped from another PDF. The prompt for this was that I reduced the resolution/size of a pdf and lost the bookmarks in the original and restored them by copying them over.</p>
<div class="highlight">
<pre><span></span><span class="k">-</span><span class="w"> </span>Import pdftk-formatted bookmarks (from dump_data_utf8)

<span class="sb">`pdftk {{to-update.pdf}} update_info_utf8 {{bookmarks.txt}} output {{updated.pdf}}`</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org65e2b58">
<h2 id="org65e2b58">Pages</h2>
<div class="outline-text-2" id="text-org65e2b58">
<p>These are <a href="https://tealdeer-rs.github.io/tealdeer/usage_custom_pages.html#custom-pages">pages</a> - whatever you put in a page file will be the starting point for the tealdeer entry - these will either start a new tealdeer entry or will clobber any exsting one that came with tealdeer. The thing that tells tealdeer that it's a page and not a patch is that the filename ends with <code>page.md</code> instead of <code>patch.md</code>. Otherwise the contents look the same.</p>
</div>
<div class="outline-3" id="outline-container-orgf3594ef">
<h3 id="orgf3594ef">MakeMKV Command Line</h3>
<div class="outline-text-3" id="text-orgf3594ef">
<p>The <code>makemkvcon</code> command has a <code>--help</code> output, which is somewhat vague. I got the information for this from a developers text file <a href="https://www.makemkv.com/developers/usage.txt">usage.txt</a> on makemkv.com/developers. Normally I use the GUI but sometimes it crashes due to errors specific to the GUI so the command line interface is useful to work around those cases.</p>
</div>
<div class="outline-4" id="outline-container-org3618a34">
<h4 id="org3618a34">List Drives</h4>
<div class="outline-text-4" id="text-org3618a34">
<p>This lists the drives as <code>makemkvcon</code> sees them.</p>
<div class="highlight">
<pre><span></span><span class="k">-</span><span class="w"> </span>List drives - DRV:index,visible,enabled,flags,drive name,disc name

<span class="sb">`makemkvcon --robot --cache=1 info disc:9999`</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Option</th>
<th class="org-left" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>--robot</code></td>
<td class="org-left">Meant for automation, tells the program to output the information to the screen</td>
</tr>
<tr>
<td class="org-left"><code>--cache=1</code></td>
<td class="org-left">Reduce the cache size (optional)</td>
</tr>
<tr>
<td class="org-left"><code>info</code></td>
<td class="org-left">The sub-command to print information</td>
</tr>
<tr>
<td class="org-left"><code>disc:9999</code></td>
<td class="org-left">Show discs (not files, etc.)</td>
</tr>
</tbody>
</table>
<p>The output looks something like:</p>
<div class="highlight">
<pre><span></span>MSG:1005,0,1,<span class="s2">"MakeMKV v1.18.2 linux(x64-release) started"</span>,<span class="s2">"%1 started"</span>,<span class="s2">"MakeMKV v1.18.2 linux(x64-release)"</span>
DRV:0,2,999,1,<span class="s2">"DVD+R-DL HL-DT-ST DVDRAM GSA-T50N RQ01 KWF9AEJ1028"</span>,<span class="s2">"MAD_MAX_FURY_ROAD"</span>,<span class="s2">"/dev/sr0"</span>
</pre></div>
<p>With more lines below it. The second line is the one I'm interested in. It has the format:</p>
<p><code>DRV:index,visible,enabled,flags,drive name,disc name</code></p>
<p>This table shows what their text file says the fields mean.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Field</th>
<th class="org-left" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">DRV</td>
<td class="org-left">This is a drive</td>
</tr>
<tr>
<td class="org-left">index</td>
<td class="org-left">The number we'll use to refer to the drive</td>
</tr>
<tr>
<td class="org-left">visible</td>
<td class="org-left">1 if drive is present</td>
</tr>
<tr>
<td class="org-left">enabled</td>
<td class="org-left">1 if drive is accessible</td>
</tr>
<tr>
<td class="org-left">flags</td>
<td class="org-left">media flags (see AP_DskFsFlagXXX in apdefs.h)</td>
</tr>
<tr>
<td class="org-left">drive name</td>
<td class="org-left">drive name string</td>
</tr>
<tr>
<td class="org-left">disc name</td>
<td class="org-left">disc name string</td>
</tr>
</tbody>
</table>
<p>Looking at the sample output, it has <code>2</code> for "visible" and <code>999</code> for "enabled", which doesn't match the expected values so I just ignore everything but the <code>drive name</code> to find the right entry in the output and the <code>index</code> for use in invoking <code>makemkvcon</code>.</p>
</div>
</div>
<div class="outline-4" id="outline-container-org8984836">
<h4 id="org8984836">Copy Disc As MKV Files</h4>
<div class="outline-text-4" id="text-org8984836">
<div class="highlight">
<pre><span></span><span class="k">-</span><span class="w"> </span>Save disk to the current directory as MKV files

<span class="sb">`makemkvcon mkv disc:{{index}} all .`</span>

<span class="k">-</span><span class="w"> </span>Save disk to another directory as MKV files

<span class="sb">`makemkvcon mkv disc:{{index}} all {{/absolute-path-to-folder/}}`</span>
</pre></div>
<p>The sample shows the output being copied to <code>c:\folder</code> which is a DOS format (I think). It didn't seem to work when I used a relative path (other than the current directory) so I assume you need to use the full path starting from <code>/home/</code>.</p>
</div>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="function-host-grep/index.html">Function: Host Grep</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="function-host-grep/index.html" rel="bookmark"><time class="published dt-published" datetime="2025-03-19T11:31:15-07:00" itemprop="datePublished" title="2025-03-19 11:31">2025-03-19 11:31</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div class="outline-2" id="outline-container-org0bc6fe2">
<h2 id="org0bc6fe2">The Function</h2>
<div class="outline-text-2" id="text-org0bc6fe2">
<p>This is a function to check what we have set-up as a hostname for the times that I forget an IP address for a device on the LAN. It checks the hosts file and the ssh-config. The <code>hosts</code> file has the IP address, but sometimes I can't remember the host-name, just the user-name, in which case checking the SSH config file can sometimes be helpful.</p>
<div class="highlight">
<pre><span></span><span class="k">function</span> hostgrep --argument-names HOST --description <span class="s2">"Look for a hostname."</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org4a6b9dc">
<h2 id="org4a6b9dc">The Parts</h2>
<div class="outline-text-2" id="text-org4a6b9dc"></div>
<div class="outline-3" id="outline-container-org4bc89fc">
<h3 id="org4bc89fc">Check Hosts</h3>
<div class="outline-text-3" id="text-org4bc89fc">
<p>First check the <code>/etc/hosts</code> file.</p>
<div class="highlight">
<pre><span></span>grep <span class="nv">$HOST</span> /etc/hosts
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org5abb39d">
<h3 id="org5abb39d">Check SSH</h3>
<div class="outline-text-3" id="text-org5abb39d">
<p>Now Check the ssh configuration.</p>
<div class="highlight">
<pre><span></span>grep --after-context <span class="m">3</span> <span class="nv">$HOST</span> <span class="nv">$HOME</span>/.ssh/config
</pre></div>
</div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="tar-xz-compression-abbreviation/index.html">Tar XZ Compression Abbreviation</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="tar-xz-compression-abbreviation/index.html" rel="bookmark"><time class="published dt-published" datetime="2024-12-01T17:36:28-08:00" itemprop="datePublished" title="2024-12-01 17:36">2024-12-01 17:36</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div class="highlight">
<pre><span></span><span class="k">function</span> xtard
    <span class="k">set</span> BASE <span class="o">(</span>string replace --regex <span class="s2">"/\$"</span> <span class="s2">""</span> <span class="nv">$argv</span><span class="o">)</span>
    tar --create --xz --file <span class="nv">$BASE</span>.tar.xz <span class="nv">$argv</span>
<span class="k">end</span>
</pre></div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="to-webp-function/index.html">To Webp Functions</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="to-webp-function/index.html" rel="bookmark"><time class="published dt-published" datetime="2024-11-20T17:28:44-08:00" itemprop="datePublished" title="2024-11-20 17:28">2024-11-20 17:28</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="to-webp-function/index.html#org02287fe">To Webp</a></li>
<li><a href="to-webp-function/index.html#org39a615b">Lossless Webp</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org02287fe">
<h2 id="org02287fe">To Webp</h2>
<div class="outline-text-2" id="text-org02287fe">
<p>A simple for loop to make using globs easier with cwebp.</p>
<div class="highlight">
<pre><span></span><span class="k">function</span> towebp -d <span class="s2">"Convert image files to web with cweb"</span>

    <span class="k">for</span> SOURCE_IMAGE <span class="k">in</span> <span class="nv">$argv</span>
        <span class="k">set</span> OUTPUT <span class="o">(</span>path change-extension webp <span class="nv">$SOURCE_IMAGE</span><span class="o">)</span>
        cwebp <span class="nv">$SOURCE_IMAGE</span> -o <span class="nv">$OUTPUT</span>
    <span class="k">end</span>
<span class="k">end</span>
</pre></div>
<p>I'm pretty sure I saw a one-liner to do this (using pipes) but it was hard to understand so I thought this would make it clearer to myself what is going on, rather than just copying a command I can't figure out.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org39a615b">
<h2 id="org39a615b">Lossless Webp</h2>
<div class="outline-text-2" id="text-org39a615b">
<p>The previous function used the default compression (lossy). This uses the lossless conversion with maximum compression and quality.</p>
<div class="notecard" id="orgd99a39f">
<p>I looked in the source code (from Google's <a href="https://chromium.googlesource.com/webm/libwebp/"><code>libwebp</code></a> git repository) and the <code>-z</code> flag is equivalent to using <code>-lossless -m 6 -q 10</code> (or whatever the max is for both of them), although for some reason it seemed to do better when I was testing it earlier…</p>
</div>
<div class="highlight">
<pre><span></span><span class="k">function</span> losslesswebp --description <span class="s1">'Convert image files to lossless webp'</span>

    <span class="k">for</span> SOURCE_IMAGE <span class="k">in</span> <span class="nv">$argv</span>
        <span class="k">set</span> OUTPUT <span class="o">(</span>path change-extension .z9.webp <span class="nv">$SOURCE_IMAGE</span><span class="o">)</span>
        cwebp -z <span class="m">9</span> <span class="nv">$SOURCE_IMAGE</span> -o <span class="nv">$OUTPUT</span>
    <span class="k">end</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="abbreviations-mother-ship/index.html">Abbreviations: Mother Ship</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="abbreviations-mother-ship/index.html" rel="bookmark"><time class="published dt-published" datetime="2024-04-25T14:22:03-07:00" itemprop="datePublished" title="2024-04-25 14:22">2024-04-25 14:22</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="abbreviations-mother-ship/index.html#orgcae1c29">Mount Drives</a></li>
</ul>
</div>
</div>
<p>This tangle is for extra configurations that are meant for PCs with a GUI that a user interacts with directly (as opposed to a server) and it has stuff that aren't going to be used on servers.</p>
<p>I'm putting it in <code>dingehaufen/conf.d/</code> so it should be linked to in <code>.config/fish/conf.d/</code> for PCs that need it.</p>
<div class="outline-2" id="outline-container-orgcae1c29">
<h2 id="orgcae1c29">Mount Drives</h2>
<div class="outline-text-2" id="text-orgcae1c29">
<p>This is an abbreviation that mounts both the cryfs folders and the external (LUKs) drive.</p>
<div class="highlight">
<pre><span></span>abbr --add -- md <span class="s2">"mountcryfs; mount-data"</span>
</pre></div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="function-mount-data/index.html">Function: Mount Data</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="function-mount-data/index.html" rel="bookmark"><time class="published dt-published" datetime="2024-04-24T14:19:08-07:00" itemprop="datePublished" title="2024-04-24 14:19">2024-04-24 14:19</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<p>This is a function to mount one of the external encrypted USB drives that I use. It makes a lot of assumptions about names so it's pretty much an alias or shortcut, but sometimes things change so I added a little bit of flexibility to it and will try to document it enough that I can figure out what it's doing if I need to change (or fix) it.</p>
<div class="outline-2" id="outline-container-orgd377175">
<h2 id="orgd377175">The Function</h2>
<div class="outline-text-2" id="text-orgd377175">
<p>This is the function declaration. There's going to be three optional arguments that it might take.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Argument</th>
<th class="org-left" scope="col">Default</th>
<th class="org-left" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><i>device</i></td>
<td class="org-left"><code>sdb1</code></td>
<td class="org-left">Name of the device as shown by <code>fdisk -l</code> without the directory (<code>/dev/</code>)</td>
</tr>
<tr>
<td class="org-left"><i>name</i></td>
<td class="org-left"><code>monkeymount</code></td>
<td class="org-left">Name to use when opening the device</td>
</tr>
<tr>
<td class="org-left"><i>folder</i></td>
<td class="org-left"><code>irvin</code></td>
<td class="org-left">Place to mount the contents of the disk (without <code>/media/</code> at the beginning).</td>
</tr>
</tbody>
</table>
<p>So if I plug in the USB drive and it shows up at <code>/dev/sda1</code> and I decide that the mapped name will be "umma" and the folder will be "gumma". Then I</p>
<div class="highlight">
<pre><span></span><span class="k">function</span> mount-data --argument-names device name folder --description <span class="s2">"Mount an encrypted drive."</span>
    <span class="k">set</span> ERROR 1
</pre></div>
<p>The <code>ERROR</code> is a number to return in the event we bail on mounting the drive for some reason.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org5674d5a">
<h2 id="org5674d5a">The Parts</h2>
<div class="outline-text-2" id="text-org5674d5a"></div>
<div class="outline-3" id="outline-container-orgc0f008a">
<h3 id="orgc0f008a">The Device</h3>
<div class="outline-text-3" id="text-orgc0f008a">
<p>This is the name of the device in <code>/dev</code> that represents the drive to mount.</p>
<p>This command is useful sometimes. More so after it's been mounted.</p>
<div class="highlight">
<pre><span></span>lsblk -e7
</pre></div>
<p>This one is generally useful if you know the model of the drive.</p>
<div class="highlight">
<pre><span></span>sudo fdisk -l <span class="o">|</span> grep sd -A 1
</pre></div>
<div class="notecard" id="orgea13705">
<p><b>Note to future self:</b> Consider making this an environment variable so you don't have to edit it if you switch USB ports.</p>
</div>
<div class="highlight">
<pre><span></span><span class="k">if</span> <span class="k">test</span> -z <span class="nv">$device</span>
    <span class="k">set</span> device <span class="s2">"sdb1"</span>
<span class="k">end</span>
</pre></div>
<p>We'll add the <code>/dev</code> to it (without checking that it's already there for now) and then make sure it's a valid block-device.</p>
<div class="highlight">
<pre><span></span><span class="k">set</span> DEVICE_PATH <span class="s2">"/dev/</span><span class="nv">$device</span><span class="s2">"</span>

<span class="k">if</span> <span class="k">not</span> <span class="k">test</span> -b <span class="nv">$DEVICE_PATH</span>
    <span class="k">echo</span> <span class="s2">"'</span><span class="nv">$DEVICE_PATH</span><span class="s2">' is not a valid block-device"</span>
    mount-data-help
    <span class="k">return</span> <span class="nv">$ERROR</span>
<span class="k">end</span>
</pre></div>
<p>To be nice we'll let the user know what we're using.</p>
<div class="highlight">
<pre><span></span><span class="k">echo</span> <span class="s2">"Using Device: </span><span class="nv">$DEVICE_PATH</span><span class="s2">"</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org5f1bfc2">
<h3 id="org5f1bfc2">The Mapping Name</h3>
<div class="outline-text-3" id="text-org5f1bfc2">
<p>This is the name that will be put into <code>/dev/mapper/</code> which <code>mount</code> will use to mount the drive.</p>
<div class="highlight">
<pre><span></span><span class="k">if</span> <span class="k">test</span> -z <span class="nv">$name</span>
    <span class="k">set</span> name <span class="s2">"monkeymount"</span>
<span class="k">end</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">echo</span> <span class="s2">"Device Mapping: </span><span class="nv">$name</span><span class="s2">"</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgfa4c24c">
<h3 id="orgfa4c24c">Mount Path</h3>
<div class="outline-text-3" id="text-orgfa4c24c">
<p>Now we'll handle the folder where the drive will be mounted. If the user doesn't give one the default is "irvin".</p>
<div class="highlight">
<pre><span></span><span class="k">if</span> <span class="k">test</span> -z <span class="nv">$folder</span>
    <span class="k">set</span> folder <span class="s2">"irvin"</span>
<span class="k">end</span>
</pre></div>
<p>We'll assume that the folder is going inside the <code>/media/</code> folder and that only the final folder (or path below <code>/media/</code>) is being passed in.</p>
<div class="highlight">
<pre><span></span><span class="k">set</span> MOUNT_PATH <span class="s2">"/media/</span><span class="nv">$folder</span><span class="s2">"</span>
</pre></div>
<p>If there's already something in the folder then we won't try and mount it.</p>
<div class="highlight">
<pre><span></span><span class="k">if</span> <span class="k">set</span> COUNT <span class="o">(</span><span class="k">count</span> <span class="o">(</span>ls <span class="nv">$MOUNT_PATH</span>/<span class="o">))</span>
    <span class="k">echo</span> <span class="s2">"</span><span class="nv">$MOUNT_PATH</span><span class="s2"> not empty, not mounting"</span>
    <span class="k">return</span> <span class="nv">$ERROR</span>
<span class="k">end</span>
</pre></div>
<p>If the folder doesn't exist we'll create it.</p>
<div class="highlight">
<pre><span></span><span class="k">if</span> <span class="k">not</span> <span class="k">test</span> -d <span class="nv">$MOUNT_PATH</span>
    <span class="k">echo</span> <span class="s2">"Creating '</span><span class="nv">$MOUNT_PATH</span><span class="s2">'"</span>
    sudo mkdir --parents <span class="nv">$MOUNT_PATH</span>
<span class="k">end</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">echo</span> <span class="s2">"Mounting at: </span><span class="nv">$MOUNT_PATH</span><span class="s2">"</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orga30f23d">
<h3 id="orga30f23d">Mounting the Drive</h3>
<div class="outline-text-3" id="text-orga30f23d">
<p>First we'll use <code>cryptsetup</code> to decrypt the drive and put the mapping into <code>/dev/mapper/</code>.</p>
<div class="highlight">
<pre><span></span><span class="k">echo</span>
<span class="k">echo</span> <span class="s2">"Mounting External Data Drive"</span>

sudo cryptsetup <span class="nb">open</span> <span class="nv">$DEVICE_PATH</span> <span class="nv">$name</span>
</pre></div>
<p>Now we'll mount the device to a folder.</p>
<div class="highlight">
<pre><span></span>sudo mount /dev/mapper/<span class="nv">$name</span> <span class="nv">$MOUNT_PATH</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org0d51cf6">
<h2 id="org0d51cf6">A Help Printer</h2>
<div class="outline-text-2" id="text-org0d51cf6">
<p>This is just a function to print a help string.</p>
<div class="highlight">
<pre><span></span><span class="k">function</span> mount-data-help
    <span class="k">echo</span> <span class="s2">"Mount an attached encrypted drive."</span>
    <span class="k">echo</span>
    <span class="k">echo</span> <span class="s2">"Usage: mount-data [device [name [folder]]]"</span>
    <span class="k">echo</span> <span class="s2">"    device: /dev/&lt;device block file&gt;"</span>
    <span class="k">echo</span> <span class="s2">"    name: /dev/wrapper/&lt;name&gt; to use"</span>
    <span class="k">echo</span> <span class="s2">"    folder: /media/&lt;folder&gt; to mount into"</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-orgf18719b">
<h2 id="orgf18719b">Links</h2>
<div class="outline-text-2" id="text-orgf18719b">
<ul class="org-ul">
<li><a href="https://fishshell.com/docs/current/cmds/not.html">fish Not</a>: Negate the exit status of a job (<code>test</code> in this case).</li>
<li><a href="https://fishshell.com/docs/current/cmds/test.html">fish test</a>: The <code>test</code> command.</li>
<li><a href="https://fishshell.com/docs/current/cmds/path.html#normalize-subcommand">Fish normalize path</a>: squash extra slashes and make it look like a valid path.</li>
</ul>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="cerberus-user-paths/index.html">Cerberus User Paths</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="cerberus-user-paths/index.html" rel="bookmark"><time class="published dt-published" datetime="2024-04-02T15:36:42-07:00" itemprop="datePublished" title="2024-04-02 15:36">2024-04-02 15:36</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="cerberus-user-paths/index.html#orgbf2714d">Links</a></li>
</ul>
</div>
</div>
<p>This is a configuration to add to the fish <code>PATH</code>. The current version of fish uses a special command called <code>fish_add_path</code> when you want to add locations to the user path. If you just naively append to the PATH in the config file then fish will keep adding to the PATH every time you log in so the <code>fish_add_path</code> prevents adding paths that are already stored in the environment variable. Unfortunately the raspberry PI I'm using has Debian 11 which has fish version 3.1.2 which predates the <code>fish_add_path</code> command so I'll have to add to the path the old fashioned way.</p>
<p>The additions will be in <code>dingehaufen/conf.d/extra_paths.fish</code> which has to be then linked or copied into <code>/.config/fish/conf.d/</code>.</p>
<div class="highlight">
<pre><span></span>contains<span class="w"> </span><span class="nv">$HOME</span>/bin<span class="w"> </span><span class="nv">$fish_user_paths</span><span class="p">;</span><span class="w"> </span>or<span class="w"> </span><span class="nb">set</span><span class="w"> </span>--universal<span class="w"> </span>--append<span class="w"> </span>fish_user_paths<span class="w"> </span><span class="nv">$HOME</span>/bin
contains<span class="w"> </span><span class="nv">$HOME</span>/.local/bin<span class="w"> </span><span class="nv">$fish_user_paths</span><span class="p">;</span><span class="w"> </span>or<span class="w"> </span><span class="nb">set</span><span class="w"> </span>--universal<span class="w"> </span>--append<span class="w"> </span>fish_user_paths<span class="w"> </span><span class="nv">$HOME</span>/.local/bin
</pre></div>
<div class="outline-2" id="outline-container-orgbf2714d">
<h2 id="orgbf2714d">Links</h2>
<div class="outline-text-2" id="text-orgbf2714d">
<ul class="org-ul">
<li><a href="https://stackoverflow.com/a/61882414">Stack Overflow</a>: Answer where I got the fish syntax.</li>
</ul>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="emacs-initel/index.html">Emacs init.el</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="emacs-initel/index.html" rel="bookmark"><time class="published dt-published" datetime="2024-04-02T13:29:37-07:00" itemprop="datePublished" title="2024-04-02 13:29">2024-04-02 13:29</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="emacs-initel/index.html#org9bffb2f">Tangle Source</a></li>
<li><a href="emacs-initel/index.html#orgf3a619f">Package Management</a></li>
<li><a href="emacs-initel/index.html#org483b97a">Pyvenv</a></li>
<li><a href="emacs-initel/index.html#org9843cec">Emacs Settings</a>
<ul>
<li><a href="emacs-initel/index.html#orgf842123">File Locks</a></li>
<li><a href="emacs-initel/index.html#org622c353">Toggle Input Mode</a></li>
</ul>
</li>
<li><a href="emacs-initel/index.html#orgfbd7f39">Tramp Mode</a>
<ul>
<li><a href="emacs-initel/index.html#org4c4992f">Use SSH</a></li>
<li><a href="emacs-initel/index.html#orgb07d0cd">No Backups</a></li>
</ul>
</li>
<li><a href="emacs-initel/index.html#org73bf8d3">God Mode</a></li>
<li><a href="emacs-initel/index.html#org166c4b7">Python and elpy</a></li>
<li><a href="emacs-initel/index.html#orgb54e350">Emacs Jupyter</a></li>
<li><a href="emacs-initel/index.html#org354538e">Fish</a></li>
<li><a href="emacs-initel/index.html#orgbb7a289">Org-mode</a></li>
<li><a href="emacs-initel/index.html#org11fbdc2">org-export python mode</a></li>
<li><a href="emacs-initel/index.html#orgdcd46c2">web-mode</a></li>
<li><a href="emacs-initel/index.html#org45ca7f1">auto-complete</a></li>
<li><a href="emacs-initel/index.html#org6637fd4">general text</a></li>
<li><a href="emacs-initel/index.html#org34cd6ff">javascript</a></li>
<li><a href="emacs-initel/index.html#org63f99a8">org-babel</a></li>
<li><a href="emacs-initel/index.html#org121064f">Feature Mode</a></li>
<li><a href="emacs-initel/index.html#org32e623f">yaml</a></li>
<li><a href="emacs-initel/index.html#orgbc9a213">Vue.js</a></li>
<li><a href="emacs-initel/index.html#org84b8b3a">Bats</a></li>
<li><a href="emacs-initel/index.html#orgb5d6510">Backups</a></li>
<li><a href="emacs-initel/index.html#org5746116">Markdown Mode</a></li>
<li><a href="emacs-initel/index.html#org7af96fa">Dockerfile Mode</a></li>
<li><a href="emacs-initel/index.html#org98c715d">Flycheck</a></li>
<li><a href="emacs-initel/index.html#org14c14c5">Keychain</a></li>
<li><a href="emacs-initel/index.html#orgadfb66b">Hideshow-Org</a></li>
</ul>
</div>
</div>
<p>This is an emacs configuration file. I had this in another repository and have been adding to it over the decades, occasionally removing things when troubleshooting but otherwise it's just a jumble right now, so I'm putting it in the fish-based repository to work on it.</p>
<p>The tangle creates a file <code>give-the-fish/dingehaufen/init.el</code> that you should copy or link into the right place <code>~/.emacs.d</code> right now.</p>
<div class="notecard" id="org3e30e37">
<p>At some post I should look into breaking up the configuration (see <a href="https://emacs.stackexchange.com/a/18441">https://emacs.stackexchange.com/a/18441</a> for an example).</p>
</div>
<div class="outline-2" id="outline-container-org9bffb2f">
<h2 id="org9bffb2f">Tangle Source</h2>
<div class="outline-text-2" id="text-org9bffb2f">
<div class="highlight">
<pre><span></span><span class="nv">&lt;&lt;package-management&gt;&gt;</span>

<span class="nv">&lt;&lt;activate-pyvenv&gt;&gt;</span>

<span class="nv">&lt;&lt;org-mode&gt;&gt;</span>

<span class="c1">;; make sure org-babel comes before jupyter or any other code-based settings</span>
<span class="nv">&lt;&lt;org-babel&gt;&gt;</span>

<span class="nv">&lt;&lt;org-export-python&gt;&gt;</span>

<span class="nv">&lt;&lt;emacs-settings&gt;&gt;</span>

<span class="nv">&lt;&lt;emacs-file-locks&gt;&gt;</span>

<span class="nv">&lt;&lt;toggle-input-method&gt;&gt;</span>

<span class="c1">;; &lt;&lt;python-elpy&gt;&gt;</span>

<span class="p">(</span><span class="nf">custom-set-variables</span>
<span class="w">       </span><span class="c1">;; custom-set-variables was added by Custom.</span>
<span class="w">       </span><span class="c1">;; If you edit it by hand, you could mess it up, so be careful.</span>
<span class="w">       </span><span class="c1">;; Your init file should contain only one such instance.</span>
<span class="w">       </span><span class="c1">;; If there is more than one, they won't work right.</span>
<span class="w">       </span><span class="o">'</span><span class="p">(</span><span class="nv">js-indent-level</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">       </span><span class="o">'</span><span class="p">(</span><span class="nv">js2-basic-offset</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">       </span><span class="o">'</span><span class="p">(</span><span class="nv">js2-bounce-indent-p</span><span class="w"> </span><span class="nv">t</span><span class="p">)</span>
<span class="w">       </span><span class="o">'</span><span class="p">(</span><span class="nv">org-export-backends</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="nv">ascii</span><span class="w"> </span><span class="nv">html</span><span class="w"> </span><span class="nv">icalendar</span><span class="w"> </span><span class="nv">latex</span><span class="w"> </span><span class="nv">org</span><span class="p">))</span>
<span class="w">       </span><span class="o">'</span><span class="p">(</span><span class="nv">package-selected-packages</span>
<span class="w">         </span><span class="p">(</span><span class="k">quote</span>
<span class="w">          </span><span class="p">(</span><span class="nf">htmlize</span><span class="w"> </span><span class="nv">ox-nikola</span><span class="w"> </span><span class="nv">ox-rst</span><span class="w"> </span><span class="nv">web-mode</span><span class="w"> </span><span class="nv">swiper</span><span class="w"> </span><span class="nv">smex</span><span class="w"> </span><span class="nv">paredit</span><span class="w"> </span><span class="nv">magit</span><span class="w"> </span><span class="nv">jedi</span><span class="w"> </span><span class="nv">ido-ubiquitous</span><span class="w"> </span><span class="nv">idle-highlight-mode</span><span class="w"> </span><span class="nv">god-mode</span><span class="w"> </span><span class="nv">fuzzy</span><span class="w"> </span><span class="nv">feature-mode</span><span class="w"> </span><span class="nv">csv-mode</span><span class="w"> </span><span class="nv">autopair</span><span class="w"> </span><span class="nv">ac-js2</span><span class="p">))))</span>

<span class="w">      </span><span class="p">(</span><span class="nf">custom-set-faces</span>
<span class="w">       </span><span class="c1">;; custom-set-faces was added by Custom.</span>
<span class="w">       </span><span class="c1">;; If you edit it by hand, you could mess it up, so be careful.</span>
<span class="w">       </span><span class="c1">;; Your init file should contain only one such instance.</span>
<span class="w">       </span><span class="c1">;; If there is more than one, they won't work right.</span>
<span class="w">       </span><span class="o">'</span><span class="p">(</span><span class="nv">rst-level-1</span><span class="w"> </span><span class="p">((</span><span class="nf">t</span><span class="w"> </span><span class="p">(</span><span class="nf">:background</span><span class="w"> </span><span class="s">"white"</span><span class="w"> </span><span class="nv">:foreground</span><span class="w"> </span><span class="s">"royal blue"</span><span class="p">))))</span>
<span class="w">       </span><span class="o">'</span><span class="p">(</span><span class="nv">rst-level-2</span><span class="w"> </span><span class="p">((</span><span class="nf">t</span><span class="w"> </span><span class="p">(</span><span class="nf">:background</span><span class="w"> </span><span class="s">"white"</span><span class="p">))))</span>
<span class="w">       </span><span class="o">'</span><span class="p">(</span><span class="nv">rst-level-3</span><span class="w"> </span><span class="p">((</span><span class="nf">t</span><span class="w"> </span><span class="p">(</span><span class="nf">:background</span><span class="w"> </span><span class="s">"cyan"</span><span class="p">))))</span>
<span class="w">       </span><span class="o">'</span><span class="p">(</span><span class="nv">rst-level-4</span><span class="w"> </span><span class="p">((</span><span class="nf">t</span><span class="w"> </span><span class="p">(</span><span class="nf">:background</span><span class="w"> </span><span class="s">"magenta"</span><span class="p">)))))</span>

<span class="w">      </span><span class="c1">;; rst minor-mode</span>
<span class="w">      </span><span class="p">(</span><span class="nf">defun</span><span class="w"> </span><span class="nv">turn-on-rst</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="nf">rst-minor-mode</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">      </span><span class="p">(</span><span class="nf">add-hook</span><span class="w"> </span><span class="ss">'python-mode-hook</span><span class="w"> </span><span class="ss">'turn-on-rst</span><span class="p">)</span>

<span class="w">      </span><span class="c1">;; hide-show mode</span>
<span class="w">      </span><span class="p">(</span><span class="nf">defun</span><span class="w"> </span><span class="nv">turn-on-hideshow</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">(</span><span class="nf">hs-minor-mode</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">      </span><span class="p">(</span><span class="nf">add-hook</span><span class="w"> </span><span class="ss">'python-mode-hook</span><span class="w"> </span><span class="ss">'turn-on-hideshow</span><span class="p">)</span>

<span class="w">      </span><span class="c1">;; make no-tabs universal</span>
<span class="w">      </span><span class="p">(</span><span class="nf">setq-default</span><span class="w"> </span><span class="nv">indent-tabs-mode</span><span class="w"> </span><span class="nv">nil</span><span class="p">)</span>

<span class="w">      </span><span class="c1">;; ipython shell</span>
<span class="w">      </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">python-shell-interpreter</span><span class="w"> </span><span class="s">"ipython"</span>
<span class="w">            </span><span class="nv">python-shell-interpreter-args</span><span class="w"> </span><span class="s">"-i"</span><span class="p">)</span>

<span class="w">      </span><span class="nv">&lt;&lt;web-mode&gt;&gt;</span>

<span class="w">      </span><span class="nv">&lt;&lt;auto-complete&gt;&gt;</span>

<span class="w">      </span><span class="p">(</span><span class="nf">define-global-minor-mode</span><span class="w"> </span><span class="nv">select-electric-pair-mode</span><span class="w"> </span><span class="nv">electric-pair-mode</span>
<span class="w">        </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">()</span>
<span class="w">          </span><span class="p">(</span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="nb">not</span><span class="w"> </span><span class="p">(</span><span class="nb">memq</span><span class="w"> </span><span class="nv">major-mode</span>
<span class="w">                           </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="ss">'web-mode</span><span class="w"> </span><span class="ss">'js2-mode</span><span class="p">)))</span>
<span class="w">            </span><span class="p">(</span><span class="nf">electric-pair-mode</span><span class="p">))))</span>

<span class="w">      </span><span class="p">(</span><span class="nf">select-electric-pair-mode</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>

<span class="w">      </span><span class="c1">;; magit</span>
<span class="w">      </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">global-magit-file-mode</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>

<span class="w">      </span><span class="c1">;; setup the keybinding to launch magit</span>
<span class="w">      </span><span class="p">(</span><span class="nf">global-set-key</span><span class="w"> </span><span class="p">(</span><span class="nf">kbd</span><span class="w"> </span><span class="s">"C-x g"</span><span class="p">)</span><span class="w"> </span><span class="ss">'magit-status</span><span class="p">)</span>

<span class="w">      </span><span class="nv">&lt;&lt;tramp-mode&gt;&gt;</span>

<span class="w">      </span><span class="nv">&lt;&lt;tramp-backups&gt;&gt;</span>

<span class="nv">&lt;&lt;god-mode&gt;&gt;</span>

<span class="nv">&lt;&lt;jupyter-emacs&gt;&gt;</span>

<span class="nv">&lt;&lt;general-text&gt;&gt;</span>

<span class="nv">&lt;&lt;javascript&gt;&gt;</span>

<span class="nv">&lt;&lt;feature-mode&gt;&gt;</span>

<span class="nv">&lt;&lt;emacs-gui&gt;&gt;</span>

<span class="nv">&lt;&lt;yaml&gt;&gt;</span>

<span class="c1">;; &lt;&lt;vue&gt;&gt;</span>

<span class="c1">;; &lt;&lt;bats&gt;&gt;</span>

<span class="nv">&lt;&lt;backups&gt;&gt;</span>

<span class="nv">&lt;&lt;no-sudo-backups&gt;&gt;</span>

<span class="c1">;; &lt;&lt;markdown-mode&gt;&gt;</span>

<span class="nv">&lt;&lt;dockerfile-mode&gt;&gt;</span>

<span class="nv">&lt;&lt;keychain&gt;&gt;</span>

<span class="nv">&lt;&lt;hideshow-org&gt;&gt;</span>

<span class="c1">;; &lt;&lt;flycheck-mypy&gt;&gt;</span>

<span class="nv">&lt;&lt;add-path&gt;&gt;</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-orgf3a619f">
<h2 id="orgf3a619f">Package Management</h2>
<div class="outline-text-2" id="text-orgf3a619f">
<div class="highlight">
<pre><span></span><span class="c1">;; emacs package management</span>
<span class="p">(</span><span class="nf">require</span><span class="w"> </span><span class="ss">'package</span><span class="p">)</span>

<span class="c1">;; add the repositories</span>
<span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'package-archives</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"melpa"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">"https://melpa.org/packages/"</span><span class="p">)</span><span class="w"> </span><span class="nv">t</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'package-archives</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"org"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">"http://orgmode.org/elpa/"</span><span class="p">)</span><span class="w"> </span><span class="nv">t</span><span class="p">)</span>

<span class="c1">;; refresh the list</span>
<span class="p">(</span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="nb">not</span><span class="w"> </span><span class="nv">package-archive-contents</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">package-refresh-contents</span><span class="p">))</span>

<span class="p">(</span><span class="nf">require</span><span class="w"> </span><span class="ss">'use-package</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org483b97a">
<h2 id="org483b97a">Pyvenv</h2>
<div class="outline-text-2" id="text-org483b97a">
<p>To prevent errors when emacs starts up and tries to load jupyter (for emacs-jupyter) we need <code>jupyter</code> to be on the path. Now that debian and ubuntu don't want you to install python packages globally we need another way. I had installed it with <a href="https://github.com/pypa/pipx">pipx</a>, which does work, but pipx doesn't doesn't install standalone libraries and sometimes breaks when trying to install dependencies so I think for this case it's better to avoid it and instead use a virtual-environment. Since it has to be activated before anything else that uses python packages, activating the environment should be put fairly early on in the <code>init.el</code> file.</p>
<div class="highlight">
<pre><span></span><span class="p">(</span><span class="nf">require</span><span class="w"> </span><span class="ss">'pyvenv</span><span class="p">)</span>
<span class="p">(</span><span class="nf">pyvenv-activate</span><span class="w"> </span><span class="s">"~/.virtualenvs/emacs-environment/"</span><span class="p">)</span>
</pre></div>
<p>This assumes that there's a virtual-environment named <code>emacs-environment</code> setup (with jupyter at least). Note that you could load <code>elpy</code> instead of just <code>pyvenv</code> by itself, but <code>elpy</code> is giving me errors (or at least lots of warnings) when it loads and I don't feel like troubleshooting it right now, since it doesn't play well with org-mode anyway.</p>
</div>
</div>
<div class="outline-2" id="outline-container-org9843cec">
<h2 id="org9843cec">Emacs Settings</h2>
<div class="outline-text-2" id="text-org9843cec">
<div class="highlight">
<pre><span></span><span class="c1">;; show column-numbers</span>
<span class="p">(</span><span class="nf">column-number-mode</span><span class="p">)</span>

<span class="c1">;; show matching parentheses</span>
<span class="p">(</span><span class="nf">show-paren-mode</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">show-paren-delay</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>

<span class="c1">;; global parentheses matching (`autopair` package needs to be installed)</span>
<span class="p">(</span><span class="nf">electric-pair-mode</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>

<span class="c1">;; turn off auto-fill mode</span>
<span class="p">(</span><span class="nf">remove-hook</span><span class="w"> </span><span class="ss">'text-mode-hook</span><span class="w"> </span><span class="o">#</span><span class="ss">'turn-on-auto-fill</span><span class="p">)</span>

<span class="c1">;; hide menu-bar by default</span>
<span class="p">(</span><span class="nf">menu-bar-mode</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span>

<span class="c1">;; hide the toolbar</span>
<span class="p">(</span><span class="nf">tool-bar-mode</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span>

<span class="c1">;; disable the scrollbar</span>
<span class="p">(</span><span class="nf">toggle-scroll-bar</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span>

<span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'default-frame-alist</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="nv">background-color</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">"white"</span><span class="p">))</span>
<span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'default-frame-alist</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="nv">foreground-color</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">"black"</span><span class="p">))</span>

<span class="c1">;; dark slate blue</span>
<span class="c1">;; (add-to-list 'default-frame-alist '(cursor-color . "#483D8B"))</span>
<span class="c1">;; dark red</span>
<span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'default-frame-alist</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="nv">cursor-color</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">"#8B0000"</span><span class="p">))</span>

<span class="c1">;; Disable Bell</span>
<span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">ring-bell-function</span><span class="w"> </span><span class="ss">'ignore</span><span class="p">)</span>
</pre></div>
</div>
<div class="outline-3" id="outline-container-orgf842123">
<h3 id="orgf842123">File Locks</h3>
<div class="outline-text-3" id="text-orgf842123">
<p>A lock got corrupted once in the cryfs directory, making the editing file unreadable. You can fix it by copying everything but the corrupted file out, destroying and re-creating the cryfs mount and copying the files back in, but hopefully this will fix it. It does mean that two people could edit the same file and cause problems, but oh, well.</p>
<div class="highlight">
<pre><span></span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">create-lockfiles</span><span class="w"> </span><span class="nv">nil</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org622c353">
<h3 id="org622c353">Toggle Input Mode</h3>
<div class="outline-text-3" id="text-org622c353">
<p>This allows you to switch to latex input and then back using <code>C-\</code>. This is useful to embed special characters. Although you could probably just do the same thing with math mode if you want to wait until exporting.</p>
<div class="highlight">
<pre><span></span><span class="c1">;; (setq default-input-method "TeX")</span>
<span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">default-input-method</span><span class="w"> </span><span class="s">"TeX"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-orgfbd7f39">
<h2 id="orgfbd7f39">Tramp Mode</h2>
<div class="outline-text-2" id="text-orgfbd7f39"></div>
<div class="outline-3" id="outline-container-org4c4992f">
<h3 id="org4c4992f">Use SSH</h3>
<div class="outline-text-3" id="text-org4c4992f">
<div class="highlight">
<pre><span></span><span class="c1">;; tramp mode</span>
<span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">tramp-default-method</span><span class="w"> </span><span class="s">"ssh"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-orgb07d0cd">
<h3 id="orgb07d0cd">No Backups</h3>
<div class="outline-text-3" id="text-orgb07d0cd">
<p>This is from the <a href="https://www.gnu.org/software/emacs/manual/html_node/tramp/Auto_002dsave-File-Lock-and-Backup.html">emacs manual</a>.</p>
</div>
<div class="outline-4" id="outline-container-org1e074aa">
<h4 id="org1e074aa">Turn Off For Tramp Only</h4>
<div class="outline-text-4" id="text-org1e074aa">
<p>The configuration is currently saving backups to a local directory, so when I use tramp I get warnings about it. It doesn't tell you why but according to the <a href="https://www.gnu.org/software/emacs/manual/html_node/tramp/Auto_002dsave-File-Lock-and-Backup.html">emacs wiki</a> this is a potential security leak (although probably not in the way I'm using it). Anyway, I've never used the backups so I'll just disable them for tramp.</p>
<div class="highlight">
<pre><span></span><span class="c1">;; disable tramp-backups</span>
<span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'backup-directory-alist</span>
<span class="w">             </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="nv">tramp-file-name-regexp</span><span class="w"> </span><span class="nv">nil</span><span class="p">))</span>
</pre></div>
<div class="notecard" id="org4723f93">
<p><b>Note:</b> This turns out to solve the wrong problem so I added another rule in the next section.</p>
</div>
</div>
</div>
<div class="outline-4" id="outline-container-org33e4242">
<h4 id="org33e4242">Turn Off For Sudo</h4>
<div class="outline-text-4" id="text-org33e4242">
<p>Turning off the backups for tramp only fixed one case, but it turned out that the thing that made me look into this was using <code>sudo</code> on my local machine to opne the <code>/etc/hosts</code> file so I was actually solving the wrong (or only part of the) problem. This next bit is supposed to turn off all backups where you use <code>sudo</code>. So it probably doesn't belong under tramp any more. Maybe I'll move it later</p>
<div class="highlight">
<pre><span></span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">backup-enable-predicate</span>
<span class="w">      </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="nf">name</span><span class="p">)</span>
<span class="w">        </span><span class="p">(</span><span class="k">and</span><span class="w"> </span><span class="p">(</span><span class="nf">normal-backup-enable-predicate</span><span class="w"> </span><span class="nv">name</span><span class="p">)</span>
<span class="w">             </span><span class="p">(</span><span class="nb">not</span>
<span class="w">              </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nf">method</span><span class="w"> </span><span class="p">(</span><span class="nf">file-remote-p</span><span class="w"> </span><span class="nv">name</span><span class="w"> </span><span class="ss">'method</span><span class="p">)))</span>
<span class="w">                </span><span class="p">(</span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="nf">stringp</span><span class="w"> </span><span class="nv">method</span><span class="p">)</span>
<span class="w">                  </span><span class="p">(</span><span class="nb">member</span><span class="w"> </span><span class="nv">method</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"su"</span><span class="w"> </span><span class="s">"sudo"</span><span class="p">))))))))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org73bf8d3">
<h2 id="org73bf8d3">God Mode</h2>
<div class="outline-text-2" id="text-org73bf8d3">
<div class="highlight">
<pre><span></span><span class="c1">;; god-mode</span>
<span class="p">(</span><span class="nf">require</span><span class="w"> </span><span class="ss">'god-mode</span><span class="p">)</span>
<span class="p">(</span><span class="nf">global-set-key</span><span class="w"> </span><span class="p">(</span><span class="nf">kbd</span><span class="w"> </span><span class="s">"&lt;escape&gt;"</span><span class="p">)</span><span class="w"> </span><span class="ss">'god-mode-all</span><span class="p">)</span>
<span class="p">(</span><span class="nf">global-set-key</span><span class="w"> </span><span class="p">(</span><span class="nf">kbd</span><span class="w"> </span><span class="s">"C-$"</span><span class="p">)</span><span class="w"> </span><span class="ss">'god-mode-all</span><span class="p">)</span>
<span class="p">(</span><span class="nf">global-set-key</span><span class="w"> </span><span class="p">(</span><span class="nf">kbd</span><span class="w"> </span><span class="s">"&lt;Scroll_Lock&gt;"</span><span class="p">)</span><span class="w"> </span><span class="ss">'god-mode-all</span><span class="p">)</span>
<span class="p">(</span><span class="nf">define-key</span><span class="w"> </span><span class="nv">god-local-mode-map</span><span class="w"> </span><span class="p">(</span><span class="nf">kbd</span><span class="w"> </span><span class="s">"."</span><span class="p">)</span><span class="w"> </span><span class="ss">'repeat</span><span class="p">)</span>

<span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">god-exempt-major-modes</span><span class="w"> </span><span class="nv">nil</span><span class="p">)</span>
<span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">god-exempt-predicates</span><span class="w"> </span><span class="nv">nil</span><span class="p">)</span>

<span class="p">(</span><span class="nf">defun</span><span class="w"> </span><span class="nv">my-update-cursor</span><span class="w"> </span><span class="p">()</span>
<span class="w">  </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">cursor-type</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">or</span><span class="w"> </span><span class="nv">god-local-mode</span><span class="w"> </span><span class="nv">buffer-read-only</span><span class="p">)</span>
<span class="w">                        </span><span class="ss">'box</span>
<span class="w">                      </span><span class="ss">'bar</span><span class="p">)))</span>
<span class="p">(</span><span class="nf">defun</span><span class="w"> </span><span class="nv">c/god-mode-update-cursor</span><span class="w"> </span><span class="p">()</span>
<span class="w">  </span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nf">limited-colors-p</span><span class="w"> </span><span class="p">(</span><span class="nb">&gt;</span><span class="w"> </span><span class="mi">257</span><span class="w"> </span><span class="p">(</span><span class="nb">length</span><span class="w"> </span><span class="p">(</span><span class="nf">defined-colors</span><span class="p">)))))</span>
<span class="w">    </span><span class="p">(</span><span class="k">cond</span><span class="w"> </span><span class="p">(</span><span class="nf">god-local-mode</span><span class="w"> </span><span class="p">(</span><span class="nf">progn</span>
<span class="w">                            </span><span class="p">(</span><span class="nf">set-face-background</span><span class="w"> </span><span class="ss">'mode-line</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="nv">limited-colors-p</span><span class="w"> </span><span class="s">"white"</span><span class="w"> </span><span class="s">"#e9e2cb"</span><span class="p">))</span>
<span class="w">                            </span><span class="p">(</span><span class="nf">set-face-background</span><span class="w"> </span><span class="ss">'mode-line-inactive</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="nv">limited-colors-p</span><span class="w"> </span><span class="s">"white"</span><span class="w"> </span><span class="s">"#e9e2cb"</span><span class="p">))))</span>
<span class="w">          </span><span class="p">(</span><span class="nf">t</span><span class="w"> </span><span class="p">(</span><span class="nf">progn</span>
<span class="w">               </span><span class="p">(</span><span class="nf">set-face-background</span><span class="w"> </span><span class="ss">'mode-line</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="nv">limited-colors-p</span><span class="w"> </span><span class="s">"black"</span><span class="w"> </span><span class="s">"#0a2832"</span><span class="p">))</span>
<span class="w">               </span><span class="p">(</span><span class="nf">set-face-background</span><span class="w"> </span><span class="ss">'mode-line-inactive</span><span class="w"> </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="nv">limited-colors-p</span><span class="w"> </span><span class="s">"black"</span><span class="w"> </span><span class="s">"#0a2832"</span><span class="p">)))))))</span>

<span class="p">(</span><span class="nf">add-hook</span><span class="w"> </span><span class="ss">'god-mode-enabled-hook</span><span class="w"> </span><span class="ss">'my-update-cursor</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-hook</span><span class="w"> </span><span class="ss">'god-mode-disabled-hook</span><span class="w"> </span><span class="ss">'my-update-cursor</span><span class="p">)</span>

<span class="c1">;; window bindings for god-mode</span>
<span class="p">(</span><span class="nf">global-set-key</span><span class="w"> </span><span class="p">(</span><span class="nf">kbd</span><span class="w"> </span><span class="s">"C-x C-o"</span><span class="p">)</span><span class="w"> </span><span class="ss">'other-window</span><span class="p">)</span>
<span class="p">(</span><span class="nf">global-set-key</span><span class="w"> </span><span class="p">(</span><span class="nf">kbd</span><span class="w"> </span><span class="s">"C-x C-1"</span><span class="p">)</span><span class="w"> </span><span class="ss">'delete-other-windows</span><span class="p">)</span>
<span class="p">(</span><span class="nf">global-set-key</span><span class="w"> </span><span class="p">(</span><span class="nf">kbd</span><span class="w"> </span><span class="s">"C-x C-2"</span><span class="p">)</span><span class="w"> </span><span class="ss">'split-window-below</span><span class="p">)</span>
<span class="p">(</span><span class="nf">global-set-key</span><span class="w"> </span><span class="p">(</span><span class="nf">kbd</span><span class="w"> </span><span class="s">"C-x C-3"</span><span class="p">)</span><span class="w"> </span><span class="ss">'split-window-right</span><span class="p">)</span>
<span class="p">(</span><span class="nf">global-set-key</span><span class="w"> </span><span class="p">(</span><span class="nf">kbd</span><span class="w"> </span><span class="s">"C-x C-0"</span><span class="p">)</span><span class="w"> </span><span class="ss">'delete-window</span><span class="p">)</span>
<span class="p">(</span><span class="nf">global-set-key</span><span class="w"> </span><span class="p">(</span><span class="nf">kbd</span><span class="w"> </span><span class="s">"C-x C-B"</span><span class="p">)</span><span class="w"> </span><span class="ss">'switch-to-buffer</span><span class="p">)</span>

<span class="c1">;; allow using 's' and 'r' for repeated searches</span>
<span class="p">(</span><span class="nf">require</span><span class="w"> </span><span class="ss">'god-mode-isearch</span><span class="p">)</span>
<span class="p">(</span><span class="nf">define-key</span><span class="w"> </span><span class="nv">isearch-mode-map</span><span class="w"> </span><span class="p">(</span><span class="nf">kbd</span><span class="w"> </span><span class="s">"&lt;escape&gt;"</span><span class="p">)</span><span class="w"> </span><span class="ss">'god-mode-isearch-activate</span><span class="p">)</span>
<span class="p">(</span><span class="nf">define-key</span><span class="w"> </span><span class="nv">god-mode-isearch-map</span><span class="w"> </span><span class="p">(</span><span class="nf">kbd</span><span class="w"> </span><span class="s">"&lt;escape&gt;"</span><span class="p">)</span><span class="w"> </span><span class="ss">'god-mode-isearch-disable</span><span class="p">)</span>

<span class="p">(</span><span class="nf">define-key</span><span class="w"> </span><span class="nv">god-local-mode-map</span><span class="w"> </span><span class="p">(</span><span class="nf">kbd</span><span class="w"> </span><span class="s">"."</span><span class="p">)</span><span class="w"> </span><span class="ss">'repeat</span><span class="p">)</span>
<span class="c1">;; set a default virtual environment</span>
<span class="p">(</span><span class="nf">pyvenv-activate</span><span class="w"> </span><span class="s">"~/.virtualenvs/emacs"</span><span class="p">)</span>

<span class="c1">;; hide-show is broken by god mode.</span>
<span class="c1">;; this adds universal quick and dirty code-folding that works</span>
<span class="p">(</span><span class="nf">defvar</span><span class="w"> </span><span class="nv">hs-special-modes-alist</span>
<span class="w">  </span><span class="p">(</span><span class="nf">mapcar</span><span class="w"> </span><span class="ss">'purecopy</span>
<span class="w">          </span><span class="o">'</span><span class="p">((</span><span class="nf">c-mode</span><span class="w"> </span><span class="s">"{"</span><span class="w"> </span><span class="s">"}"</span><span class="w"> </span><span class="s">"/[*/]"</span><span class="w"> </span><span class="nv">nil</span><span class="w"> </span><span class="nv">nil</span><span class="p">)</span>
<span class="w">            </span><span class="p">(</span><span class="nf">c++-mode</span><span class="w"> </span><span class="s">"{"</span><span class="w"> </span><span class="s">"}"</span><span class="w"> </span><span class="s">"/[*/]"</span><span class="w"> </span><span class="nv">nil</span><span class="w"> </span><span class="nv">nil</span><span class="p">)</span>
<span class="w">            </span><span class="p">(</span><span class="nf">bibtex-mode</span><span class="w"> </span><span class="p">(</span><span class="s">"@</span><span class="se">\\</span><span class="s">S(*</span><span class="se">\\</span><span class="s">(</span><span class="se">\\</span><span class="s">s(</span><span class="se">\\</span><span class="s">)"</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">            </span><span class="p">(</span><span class="nf">java-mode</span><span class="w"> </span><span class="s">"{"</span><span class="w"> </span><span class="s">"}"</span><span class="w"> </span><span class="s">"/[*/]"</span><span class="w"> </span><span class="nv">nil</span><span class="w"> </span><span class="nv">nil</span><span class="p">)</span>
<span class="w">            </span><span class="p">(</span><span class="nf">js2-mode</span><span class="w"> </span><span class="s">"{"</span><span class="w"> </span><span class="s">"}"</span><span class="w"> </span><span class="s">"/[*/]"</span><span class="w"> </span><span class="nv">nil</span><span class="p">))))</span>

<span class="p">(</span><span class="nf">defun</span><span class="w"> </span><span class="nv">toggle-selective-display</span><span class="w"> </span><span class="p">(</span><span class="nf">column</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">interactive</span><span class="w"> </span><span class="s">"P"</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">set-selective-display</span>
<span class="w">   </span><span class="p">(</span><span class="k">or</span><span class="w"> </span><span class="nv">column</span>
<span class="w">       </span><span class="p">(</span><span class="k">unless</span><span class="w"> </span><span class="nv">selective-display</span>
<span class="w">         </span><span class="p">(</span><span class="nb">1+</span><span class="w"> </span><span class="p">(</span><span class="nf">current-column</span><span class="p">))))))</span>

<span class="p">(</span><span class="nf">defun</span><span class="w"> </span><span class="nv">toggle-hiding</span><span class="w"> </span><span class="p">(</span><span class="nf">column</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">interactive</span><span class="w"> </span><span class="s">"P"</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="nv">hs-minor-mode</span>
<span class="w">      </span><span class="p">(</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nf">condition-case</span><span class="w"> </span><span class="nv">nil</span>
<span class="w">              </span><span class="p">(</span><span class="nf">hs-toggle-hiding</span><span class="p">)</span>
<span class="w">            </span><span class="p">(</span><span class="nb">error</span><span class="w"> </span><span class="nv">t</span><span class="p">))</span>
<span class="w">          </span><span class="p">(</span><span class="nf">hs-show-all</span><span class="p">))</span>
<span class="w">    </span><span class="p">(</span><span class="nf">toggle-selective-display</span><span class="w"> </span><span class="nv">column</span><span class="p">)))</span>
<span class="p">(</span><span class="nf">load-library</span><span class="w"> </span><span class="s">"hideshow"</span><span class="p">)</span>
<span class="p">(</span><span class="nf">global-set-key</span><span class="w"> </span><span class="p">(</span><span class="nf">kbd</span><span class="w"> </span><span class="s">"C-+"</span><span class="p">)</span><span class="w"> </span><span class="ss">'toggle-hiding</span><span class="p">)</span>
<span class="p">(</span><span class="nf">global-set-key</span><span class="w"> </span><span class="p">(</span><span class="nf">kbd</span><span class="w"> </span><span class="s">"C-|"</span><span class="p">)</span><span class="w"> </span><span class="ss">'toggle-selective-display</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-hook</span><span class="w"> </span><span class="ss">'java-mode-hook</span><span class="w">       </span><span class="ss">'hs-minor-mode</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-hook</span><span class="w"> </span><span class="ss">'sh-mode-hook</span><span class="w">         </span><span class="ss">'hs-minor-mode</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-hook</span><span class="w"> </span><span class="ss">'js2-mode-hook</span><span class="w">         </span><span class="ss">'hs-minor-mode</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org166c4b7">
<h2 id="org166c4b7">Python and elpy</h2>
<div class="outline-text-2" id="text-org166c4b7">
<div class="highlight">
<pre><span></span><span class="w">  </span><span class="c1">;; elpy</span>
<span class="p">(</span><span class="nf">use-package</span><span class="w"> </span><span class="nv">elpy</span>
<span class="w">  </span><span class="nv">:ensure</span><span class="w"> </span><span class="nv">t</span>
<span class="w">  </span><span class="nv">:defer</span><span class="w"> </span><span class="nv">t</span>
<span class="w">  </span><span class="nv">:init</span>
<span class="w">  </span><span class="p">(</span><span class="nf">advice-add</span><span class="w"> </span><span class="ss">'python-mode</span><span class="w"> </span><span class="nv">:before</span><span class="w"> </span><span class="ss">'elpy-enable</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'auto-mode-alist</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"</span><span class="se">\\</span><span class="s">.py"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">python-mode</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-orgb54e350">
<h2 id="orgb54e350">Emacs Jupyter</h2>
<div class="outline-text-2" id="text-orgb54e350">
<p>The <code>org-babel-jupyter-override-src-block</code> function is loaded by the <code>ob-jupyter</code> package and sometimes fails if it isn't loaded yet. This only seems to happen while troubleshooting and the init file is being altered, but since it's confusing when it does happen (and a distraction from whatever I'm actually fixing) I'm adding the solution from <a href="https://github.com/emacs-jupyter/jupyter/issues/461#issuecomment-1678501097">this github bug report</a> (the <code>with-eval-after-load</code> function will wait until the init file is loaded).</p>
<div class="highlight">
<pre><span></span><span class="p">(</span><span class="nf">with-eval-after-load</span><span class="w"> </span><span class="ss">'ob-jupyter</span>
<span class="w">  </span><span class="p">(</span><span class="nf">org-babel-jupyter-override-src-block</span><span class="w"> </span><span class="s">"python"</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org354538e">
<h2 id="org354538e">Fish</h2>
<div class="outline-text-2" id="text-org354538e">
<div class="highlight">
<pre><span></span><span class="c1">;; fish functions</span>
<span class="o">'</span><span class="p">(</span><span class="nv">sh-basic-offset</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="o">'</span><span class="p">(</span><span class="nv">sh-indentation</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">auto-mode-alist</span><span class="w"> </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"</span><span class="se">\\</span><span class="s">.fish$"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">shell-script-mode</span><span class="p">)</span><span class="w"> </span><span class="nv">auto-mode-alist</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-orgbb7a289">
<h2 id="orgbb7a289">Org-mode</h2>
<div class="outline-text-2" id="text-orgbb7a289">
<div class="highlight">
<pre><span></span><span class="w">  </span><span class="c1">;; org-mode</span>
<span class="w">  </span><span class="p">(</span><span class="nf">require</span><span class="w"> </span><span class="ss">'org</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">define-key</span><span class="w"> </span><span class="nv">global-map</span><span class="w"> </span><span class="s">"</span><span class="se">\C</span><span class="s">-cl"</span><span class="w"> </span><span class="ss">'org-store-link</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">define-key</span><span class="w"> </span><span class="nv">global-map</span><span class="w"> </span><span class="s">"</span><span class="se">\C</span><span class="s">-ca"</span><span class="w"> </span><span class="ss">'org-agenda</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">org-log-done</span><span class="w"> </span><span class="nv">t</span><span class="p">)</span>

<span class="w">  </span><span class="c1">;; org-mode agendas</span>
<span class="w">  </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">org-agenda-files</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="w"> </span><span class="s">"~/documents/roku-chiji/repository/kanban.org"</span><span class="p">))</span>

<span class="w">  </span><span class="c1">;; org-capture</span>
<span class="w">  </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">org-default-notes-file</span><span class="w"> </span><span class="p">(</span><span class="nf">concat</span><span class="w"> </span><span class="s">"~/documents/roku-chiji/repository/"</span><span class="w"> </span><span class="s">"bugs.org"</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nf">define-key</span><span class="w"> </span><span class="nv">global-map</span><span class="w"> </span><span class="s">"</span><span class="se">\C</span><span class="s">-cc"</span><span class="w"> </span><span class="ss">'org-capture</span><span class="p">)</span>

<span class="w">  </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">org-capture-templates</span>
<span class="w">        </span><span class="o">'</span><span class="p">((</span><span class="s">"b"</span><span class="w"> </span><span class="s">"Bug"</span><span class="w"> </span><span class="nv">entry</span><span class="w"> </span><span class="p">(</span><span class="nf">file+headline</span><span class="w"> </span><span class="s">"~/documents/roku-chiji/repository/bugs.org"</span><span class="w"> </span><span class="s">"Bugs"</span><span class="p">)</span>
<span class="w">           </span><span class="s">"* BUG %?</span><span class="se">\n</span><span class="s">  %i</span><span class="se">\n</span><span class="s">  %a"</span><span class="p">)))</span>

<span class="w">  </span><span class="c1">;; todo-state names</span>
<span class="w">  </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">org-todo-keywords</span>
<span class="w">          </span><span class="o">'</span><span class="p">((</span><span class="nf">sequence</span><span class="w"> </span><span class="s">"TOMORROW"</span><span class="w"> </span><span class="s">"TODAY"</span><span class="w"> </span><span class="s">"DOING"</span><span class="w"> </span><span class="s">"|"</span><span class="w"> </span><span class="s">"DONE"</span><span class="p">)))</span>

<span class="w">  </span><span class="c1">;; org clean-outlines</span>

<span class="w">  </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">org-startup-indented</span><span class="w"> </span><span class="nv">t</span>
<span class="w">        </span><span class="nv">org-hide-leading-stars</span><span class="w"> </span><span class="nv">t</span>
<span class="w">        </span><span class="nv">org-indent-indentation-per-level</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>

<span class="w">  </span><span class="c1">;; word-wrap</span>
<span class="w">  </span><span class="p">(</span><span class="nf">global-visual-line-mode</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>

<span class="w">  </span><span class="c1">;; start the calendar on monday</span>
<span class="w">  </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">calendar-week-start-day</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>

<span class="w">  </span><span class="c1">;; start with outline folded</span>
<span class="w">  </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">org-startup-folded</span><span class="w"> </span><span class="nv">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org11fbdc2">
<h2 id="org11fbdc2">org-export python mode</h2>
<div class="outline-text-2" id="text-org11fbdc2">
<p>This just stops emitting the message that emacs is using a default 4 spaces when exporting python.</p>
<div class="highlight">
<pre><span></span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">python-indent-guess-indent-offset</span><span class="w"> </span><span class="nv">t</span><span class="p">)</span><span class="w">  </span>
<span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">python-indent-guess-indent-offset-verbose</span><span class="w"> </span><span class="nv">nil</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-orgdcd46c2">
<h2 id="orgdcd46c2">web-mode</h2>
<div class="outline-text-2" id="text-orgdcd46c2">
<div class="highlight">
<pre><span></span><span class="w">  </span><span class="c1">;; web-mode</span>
<span class="w">  </span><span class="p">(</span><span class="nf">require</span><span class="w"> </span><span class="ss">'web-mode</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'auto-mode-alist</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"</span><span class="se">\\</span><span class="s">.html?</span><span class="se">\\</span><span class="s">'"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">web-mode</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'auto-mode-alist</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"</span><span class="se">\\</span><span class="s">.tmpl</span><span class="se">\\</span><span class="s">'"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">web-mode</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'auto-mode-alist</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"</span><span class="se">\\</span><span class="s">.phtml</span><span class="se">\\</span><span class="s">'"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">web-mode</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'auto-mode-alist</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"</span><span class="se">\\</span><span class="s">.tpl</span><span class="se">\\</span><span class="s">.php</span><span class="se">\\</span><span class="s">'"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">web-mode</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'auto-mode-alist</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"</span><span class="se">\\</span><span class="s">.[agj]sp</span><span class="se">\\</span><span class="s">'"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">web-mode</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'auto-mode-alist</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"</span><span class="se">\\</span><span class="s">.as[cp]x</span><span class="se">\\</span><span class="s">'"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">web-mode</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'auto-mode-alist</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"</span><span class="se">\\</span><span class="s">.erb</span><span class="se">\\</span><span class="s">'"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">web-mode</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'auto-mode-alist</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"</span><span class="se">\\</span><span class="s">.mustache</span><span class="se">\\</span><span class="s">'"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">web-mode</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'auto-mode-alist</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"</span><span class="se">\\</span><span class="s">.djhtml</span><span class="se">\\</span><span class="s">'"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">web-mode</span><span class="p">))</span>

<span class="w">  </span><span class="p">(</span><span class="nf">defun</span><span class="w"> </span><span class="nv">my-web-mode-hook</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="s">"Hooks for Web mode."</span>
<span class="w">    </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">web-mode-markup-indent-offset</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">web-mode-css-indent-offset</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">web-mode-code-indent-offset</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">web-mode-enable-current-column-highlight</span><span class="w"> </span><span class="nv">t</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">web-mode-enable-current-element-highlight</span><span class="w"> </span><span class="nv">t</span><span class="p">)</span>
<span class="w">    </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">web-mode-engines-alist</span>
<span class="w">        </span><span class="o">'</span><span class="p">((</span><span class="s">"jinja"</span><span class="w">    </span><span class="o">.</span><span class="w"> </span><span class="s">"</span><span class="se">\\</span><span class="s">.html</span><span class="se">\\</span><span class="s">'"</span><span class="p">))</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-hook</span><span class="w"> </span><span class="ss">'web-mode-hook</span><span class="w">  </span><span class="ss">'my-web-mode-hook</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org45ca7f1">
<h2 id="org45ca7f1">auto-complete</h2>
<div class="outline-text-2" id="text-org45ca7f1">
<div class="highlight">
<pre><span></span><span class="w">  </span><span class="c1">;; auto-complete</span>
<span class="w">  </span><span class="c1">;; (defun turn-on-autocomplete () (auto-complete-mode 1))</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'load-path</span><span class="w"> </span><span class="s">"~/.emacs.d/lisp"</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">require</span><span class="w"> </span><span class="ss">'auto-complete-config</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'ac-dictionary-directories</span><span class="w"> </span><span class="s">"~/.emacs.d/ac-dict"</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">ac-config-default</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">defadvice</span><span class="w"> </span><span class="nv">auto-complete-mode</span><span class="w"> </span><span class="p">(</span><span class="nf">around</span><span class="w"> </span><span class="nv">disable-auto-complete-for-python</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="k">unless</span><span class="w"> </span><span class="p">(</span><span class="nf">eq</span><span class="w"> </span><span class="nv">major-mode</span><span class="w"> </span><span class="ss">'python-mode</span><span class="p">)</span><span class="w"> </span><span class="nv">ad-do-it</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org6637fd4">
<h2 id="org6637fd4">general text</h2>
<div class="outline-text-2" id="text-org6637fd4">
<div class="highlight">
<pre><span></span><span class="c1">;; increase/decrease text size</span>
<span class="p">(</span><span class="nf">global-set-key</span><span class="w"> </span><span class="p">(</span><span class="nf">kbd</span><span class="w"> </span><span class="s">"C-c C-+"</span><span class="p">)</span><span class="w"> </span><span class="ss">'text-scale-increase</span><span class="p">)</span>
<span class="p">(</span><span class="nf">global-set-key</span><span class="w"> </span><span class="p">(</span><span class="nf">kbd</span><span class="w"> </span><span class="s">"C--"</span><span class="p">)</span><span class="w"> </span><span class="ss">'text-scale-decrease</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org34cd6ff">
<h2 id="org34cd6ff">javascript</h2>
<div class="outline-text-2" id="text-org34cd6ff">
<div class="highlight">
<pre><span></span><span class="c1">;; js2</span>
<span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'auto-mode-alist</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"</span><span class="se">\\</span><span class="s">.js</span><span class="se">\\</span><span class="s">'"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">js2-mode</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org63f99a8">
<h2 id="org63f99a8">org-babel</h2>
<div class="outline-text-2" id="text-org63f99a8">
<div class="highlight">
<pre><span></span><span class="w">  </span><span class="c1">;; org-babel</span>
<span class="p">(</span><span class="nf">require</span><span class="w"> </span><span class="ss">'ob-js</span><span class="p">)</span>

<span class="w">  </span><span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'org-src-lang-modes</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"rst"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">"rst"</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'org-src-lang-modes</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"feature"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">"feature"</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'org-src-lang-modes</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"org"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">"org"</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'org-src-lang-modes</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"css"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">"css"</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'org-src-lang-modes</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"plantuml"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">"plantuml"</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'org-src-lang-modes</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"conf"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">"conf"</span><span class="p">))</span>

<span class="w">  </span><span class="p">(</span><span class="nf">org-babel-do-load-languages</span>
<span class="w">   </span><span class="ss">'org-babel-load-languages</span>
<span class="w">   </span><span class="o">'</span><span class="p">(</span>
<span class="w">     </span><span class="p">(</span><span class="nf">plantuml</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">t</span><span class="p">)</span>
<span class="w">     </span><span class="p">(</span><span class="nf">shell</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">t</span><span class="p">)</span>
<span class="w">     </span><span class="p">(</span><span class="nf">emacs-lisp</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">t</span><span class="p">)</span>
<span class="w">     </span><span class="p">(</span><span class="nf">latex</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">t</span><span class="p">)</span>
<span class="w">     </span><span class="p">(</span><span class="nf">org</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">t</span><span class="p">)</span>
<span class="w">     </span><span class="p">(</span><span class="nf">js</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">t</span><span class="p">)</span>
<span class="w">     </span><span class="p">(</span><span class="nf">jupyter</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">t</span><span class="p">)</span>
<span class="w">     </span><span class="p">))</span>

<span class="w">  </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">org-plantuml-jar-path</span><span class="w"> </span><span class="p">(</span><span class="nf">expand-file-name</span><span class="w"> </span><span class="s">"/usr/share/java/plantuml.jar"</span><span class="p">))</span>

<span class="w">  </span><span class="c1">;; Don't treat underscores as sub-script notation</span>
<span class="w">  </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">org-export-with-sub-superscripts</span><span class="w"> </span><span class="nv">nil</span><span class="p">)</span>

<span class="w">  </span><span class="c1">;; Don't re-evaluate the source blocks before exporting</span>
<span class="w">  </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">org-export-babel-evaluate</span><span class="w"> </span><span class="nv">nil</span><span class="p">)</span>

<span class="w">  </span><span class="c1">;; don't confirm block evaluation</span>
<span class="w">  </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">org-confirm-babel-evaluate</span><span class="w"> </span><span class="nv">nil</span><span class="p">)</span>

<span class="w">  </span><span class="c1">;;; display/update images in the buffer after evaluation</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-hook</span><span class="w"> </span><span class="ss">'org-babel-after-execute-hook</span><span class="w"> </span><span class="ss">'org-display-inline-images</span><span class="w"> </span><span class="ss">'append</span><span class="p">)</span>

<span class="w">  </span><span class="c1">;; noweb expansion only when you tangle</span>
<span class="w">  </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">org-babel-default-header-args</span>
<span class="w">        </span><span class="p">(</span><span class="nb">cons</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="nv">:noweb</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">"tangle"</span><span class="p">)</span>
<span class="w">              </span><span class="p">(</span><span class="nf">assq-delete-all</span><span class="w"> </span><span class="nv">:noweb</span><span class="w"> </span><span class="nv">org-babel-default-header-args</span><span class="p">))</span>
<span class="w">        </span><span class="p">)</span>

<span class="w">  </span><span class="c1">;; syntax highlighting in org-files</span>
<span class="w">  </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">org-src-fontify-natively</span><span class="w"> </span><span class="nv">t</span><span class="p">)</span>

<span class="w">  </span><span class="c1">;; export org to rst</span>
<span class="w">  </span><span class="p">(</span><span class="nf">require</span><span class="w"> </span><span class="ss">'ox-rst</span><span class="p">)</span>

<span class="w">  </span><span class="c1">;; export org to nikola</span>
<span class="w">  </span><span class="p">(</span><span class="nf">require</span><span class="w"> </span><span class="ss">'ox-nikola</span><span class="p">)</span>

<span class="w">  </span><span class="c1">;; export to latex/pdf</span>
<span class="w">  </span><span class="p">(</span><span class="nf">require</span><span class="w"> </span><span class="ss">'ox-latex</span><span class="p">)</span>

<span class="w">  </span><span class="c1">;; syntax-highlighting for pdf's</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'org-latex-packages-alist</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">""</span><span class="w"> </span><span class="s">"minted"</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">org-latex-listings</span><span class="w"> </span><span class="ss">'minted</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">org-latex-pdf-process</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"pdflatex -shell-escape -interaction nonstopmode -output-directory %o %f"</span><span class="p">))</span>

<span class="w">  </span><span class="c1">;; let the user set the indentation so you can insert text between methods in classes.</span>
<span class="w">  </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">org-src-preserve-indentation</span><span class="w"> </span><span class="nv">t</span><span class="p">)</span>

<span class="w">  </span><span class="c1">;; pygmentize ipython</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'org-latex-minted-langs</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="nv">ipython</span><span class="w"> </span><span class="s">"python"</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org121064f">
<h2 id="org121064f">Feature Mode</h2>
<div class="outline-text-2" id="text-org121064f">
<div class="highlight">
<pre><span></span><span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'auto-mode-alist</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"</span><span class="se">\\</span><span class="s">.feature"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">feature-mode</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org32e623f">
<h2 id="org32e623f">yaml</h2>
<div class="outline-text-2" id="text-org32e623f">
<div class="highlight">
<pre><span></span><span class="p">(</span><span class="nf">add-hook</span><span class="w"> </span><span class="ss">'yaml-mode-hook</span>
<span class="w">          </span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">()</span>
<span class="w">            </span><span class="p">(</span><span class="nf">define-key</span><span class="w"> </span><span class="nv">yaml-mode-map</span><span class="w"> </span><span class="s">"</span><span class="se">\C</span><span class="s">-m"</span><span class="w"> </span><span class="ss">'newline-and-indent</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-orgbc9a213">
<h2 id="orgbc9a213">Vue.js</h2>
<div class="outline-text-2" id="text-orgbc9a213">
<div class="highlight">
<pre><span></span><span class="c1">;; setup files ending in “.vue” to open in vue-mode</span>
<span class="c1">;; (add-to-list 'auto-mode-alist '("\\.vue\\'" . vue-mode))</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org84b8b3a">
<h2 id="org84b8b3a">Bats</h2>
<div class="outline-text-2" id="text-org84b8b3a">
<p>The Bash Automated Test System mode.</p>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-left">
<col class="org-left"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Keybinding</th>
<th class="org-left" scope="col">Description</th>
<th class="org-left" scope="col">State</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">C-c C-a</td>
<td class="org-left">Run all bat-files in the current directory</td>
<td class="org-left">Works</td>
</tr>
<tr>
<td class="org-left">C-c C-,</td>
<td class="org-left">Run all the tests in the current buffer</td>
<td class="org-left">Works</td>
</tr>
<tr>
<td class="org-left">C-c M-,</td>
<td class="org-left">Run the test where the cursor is</td>
<td class="org-left">Doesn't Work</td>
</tr>
</tbody>
</table>
<p>There's a ticket on github to add this feature (?) to bats, but the old developers stopped supporting it and I don't know if the fork has it yet. It isn't working if you install bats from Ubuntu's repositories as of Bionic Beaver.</p>
<div class="highlight">
<pre><span></span><span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'auto-mode-alist</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"</span><span class="se">\\</span><span class="s">.bat</span><span class="se">\\</span><span class="s">'"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">bats-mode</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-orgb5d6510">
<h2 id="orgb5d6510">Backups</h2>
<div class="outline-text-2" id="text-orgb5d6510">
<p>From the <a href="https://www.emacswiki.org/emacs/BackupDirectory">Emacs Wiki</a>.</p>
<div class="highlight">
<pre><span></span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">backup-directory-alist</span><span class="w"> </span>
<span class="w">      </span><span class="o">'</span><span class="p">((</span><span class="s">"."</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="s">"/tmp/"</span><span class="p">)))</span>
<span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">auto-save-file-name-transforms</span>
<span class="w">      </span><span class="o">`</span><span class="p">((</span><span class="s">".*"</span><span class="w"> </span><span class="o">,</span><span class="w"> </span><span class="s">"/tmp/"</span><span class="w"> </span><span class="nv">t</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org5746116">
<h2 id="org5746116">Markdown Mode</h2>
<div class="outline-text-2" id="text-org5746116">
<div class="highlight">
<pre><span></span><span class="p">(</span><span class="nf">use-package</span><span class="w"> </span><span class="nv">markdown-mode</span>
<span class="w"> </span><span class="nv">:ensure</span><span class="w"> </span><span class="nv">t</span>
<span class="w"> </span><span class="nv">:mode</span><span class="w"> </span><span class="p">((</span><span class="s">"README</span><span class="se">\\</span><span class="s">.md</span><span class="se">\\</span><span class="s">'"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">gfm-mode</span><span class="p">)</span>
<span class="w">         </span><span class="p">(</span><span class="s">"</span><span class="se">\\</span><span class="s">.md</span><span class="se">\\</span><span class="s">'"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">markdown-mode</span><span class="p">)</span>
<span class="w">         </span><span class="p">(</span><span class="s">"</span><span class="se">\\</span><span class="s">.markdown</span><span class="se">\\</span><span class="s">'"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">markdown-mode</span><span class="p">))</span>
<span class="w"> </span><span class="nv">:init</span><span class="w"> </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">markdown-command</span><span class="w"> </span><span class="s">"pandoc"</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org7af96fa">
<h2 id="org7af96fa">Dockerfile Mode</h2>
<div class="outline-text-2" id="text-org7af96fa">
<div class="highlight">
<pre><span></span><span class="p">(</span><span class="nf">require</span><span class="w"> </span><span class="ss">'dockerfile-mode</span><span class="p">)</span>
<span class="p">(</span><span class="nf">add-to-list</span><span class="w"> </span><span class="ss">'auto-mode-alist</span><span class="w"> </span><span class="o">'</span><span class="p">(</span><span class="s">"Dockerfile</span><span class="se">\\</span><span class="s">'"</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">dockerfile-mode</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org98c715d">
<h2 id="org98c715d">Flycheck</h2>
<div class="outline-text-2" id="text-org98c715d">
<div class="highlight">
<pre><span></span><span class="c1">;; flycheck</span>
<span class="p">(</span><span class="nf">use-package</span><span class="w"> </span><span class="nv">flycheck</span>
<span class="w">  </span><span class="nv">:ensure</span><span class="w"> </span><span class="nv">t</span>
<span class="w">  </span><span class="nv">:config</span>
<span class="w">  </span><span class="p">(</span><span class="nf">global-flycheck-mode</span><span class="w"> </span><span class="nv">t</span><span class="p">)</span>
<span class="w">  </span><span class="c1">;; note that these bindings are optional</span>
<span class="w">  </span><span class="p">(</span><span class="nf">global-set-key</span><span class="w"> </span><span class="p">(</span><span class="nf">kbd</span><span class="w"> </span><span class="s">"C-c n"</span><span class="p">)</span><span class="w"> </span><span class="ss">'flycheck-next-error</span><span class="p">)</span>
<span class="w">  </span><span class="c1">;; this might override a default binding for running a python process,</span>
<span class="w">  </span><span class="c1">;; see comments below this answer</span>
<span class="w">  </span><span class="p">(</span><span class="nf">global-set-key</span><span class="w"> </span><span class="p">(</span><span class="nf">kbd</span><span class="w"> </span><span class="s">"C-c p"</span><span class="p">)</span><span class="w"> </span><span class="ss">'flycheck-prev-error</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="c1">;; flycheck-pycheckers</span>
<span class="c1">;; Allows multiple syntax checkers to run in parallel on Python code</span>
<span class="c1">;; Ideal use-case: pyflakes for syntax combined with mypy for typing</span>
<span class="p">(</span><span class="nf">use-package</span><span class="w"> </span><span class="nv">flycheck-pycheckers</span>
<span class="w">  </span><span class="nv">:after</span><span class="w"> </span><span class="nv">flycheck</span>
<span class="w">  </span><span class="nv">:ensure</span><span class="w"> </span><span class="nv">t</span>
<span class="w">  </span><span class="nv">:init</span>
<span class="w">  </span><span class="p">(</span><span class="nf">with-eval-after-load</span><span class="w"> </span><span class="ss">'flycheck</span>
<span class="w">    </span><span class="p">(</span><span class="nf">add-hook</span><span class="w"> </span><span class="ss">'flycheck-mode-hook</span><span class="w"> </span><span class="o">#</span><span class="ss">'flycheck-pycheckers-setup</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">flycheck-pycheckers-checkers</span>
<span class="w">    </span><span class="o">'</span><span class="p">(</span>
<span class="w">      </span><span class="nv">mypy3</span>
<span class="w">      </span><span class="nv">pyflakes</span>
<span class="w">      </span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
<span class="c1">;; elpy</span>
<span class="p">(</span><span class="nf">use-package</span><span class="w"> </span><span class="nv">elpy</span>
<span class="w">  </span><span class="nv">:after</span><span class="w"> </span><span class="nv">poetry</span>
<span class="w">  </span><span class="nv">:ensure</span><span class="w"> </span><span class="nv">t</span>
<span class="w">  </span><span class="nv">:config</span>
<span class="w">  </span><span class="p">(</span><span class="nf">elpy-enable</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-hook</span><span class="w"> </span><span class="ss">'elpy-mode-hook</span><span class="w"> </span><span class="ss">'poetry-tracking-mode</span><span class="p">)</span><span class="w"> </span><span class="c1">;; optional if you're using Poetry</span>
<span class="w">  </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">elpy-rpc-virtualenv-path</span><span class="w"> </span><span class="ss">'current</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">elpy-syntax-check-command</span><span class="w"> </span><span class="s">"~/.virtualenvs/neurotic-networks/bin/pyflakes"</span><span class="p">)</span><span class="w"> </span><span class="c1">;; or replace with the path to your pyflakes binary</span>
<span class="w">  </span><span class="c1">;; allows Elpy to see virtualenv</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-hook</span><span class="w"> </span><span class="ss">'elpy-mode-hook</span>
<span class="w">        </span><span class="c1">;; pyvenv-mode</span>
<span class="w">        </span><span class="o">'</span><span class="p">(</span><span class="k">lambda</span><span class="w"> </span><span class="p">()</span>
<span class="w">           </span><span class="p">(</span><span class="nf">pyvenv-mode</span><span class="w"> </span><span class="mi">+1</span><span class="p">)</span>
<span class="w">           </span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">  </span><span class="c1">;; use flycheck instead of flymake</span>
<span class="w">  </span><span class="p">(</span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="k">load</span><span class="w"> </span><span class="s">"flycheck"</span><span class="w"> </span><span class="nv">t</span><span class="w"> </span><span class="nv">t</span><span class="p">)</span>
<span class="w">  </span><span class="p">(</span><span class="nf">setq</span><span class="w"> </span><span class="nv">elpy-modules</span><span class="w"> </span><span class="p">(</span><span class="nb">delq</span><span class="w"> </span><span class="ss">'elpy-module-flymake</span><span class="w"> </span><span class="nv">elpy-modules</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nf">add-hook</span><span class="w"> </span><span class="ss">'elpy-mode-hook</span><span class="w"> </span><span class="ss">'flycheck-mode</span><span class="p">))</span>
<span class="w">  </span><span class="p">)</span>
<span class="c1">;; poetry</span>
<span class="p">(</span><span class="nf">use-package</span><span class="w"> </span><span class="nv">poetry</span>
<span class="w">  </span><span class="nv">:ensure</span><span class="w"> </span><span class="nv">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org14c14c5">
<h2 id="org14c14c5">Keychain</h2>
<div class="outline-text-2" id="text-org14c14c5">
<p>This is to be able to use ssh-agent (via keychain).</p>
<ul class="org-ul">
<li>`keychain` needs to be installed (e.g. via apt)</li>
<li>It needs to be running - Add this to the fish.config</li>
</ul>
<div class="highlight">
<pre><span></span><span class="k">if</span> <span class="nb">status</span> --is-interactive
 keychain --eval --quiet -Q id_rsa <span class="o">|</span> <span class="nb">source</span>
<span class="k">end</span>
</pre></div>
<div class="highlight">
<pre><span></span>(require 'keychain-environment)
(keychain-refresh-environment)
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-orgadfb66b">
<h2 id="orgadfb66b">Hideshow-Org</h2>
<div class="outline-text-2" id="text-orgadfb66b">
<div class="highlight">
<pre><span></span>(add-to-list 'load-path "~/projects/third-party/hideshow-org/")
(require 'hideshow-org)
</pre></div>
</div>
</div>
</div>
</article>
<article class="h-entry post-text" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title"><a class="u-url" href="convert-a-document-to-pdf-with-pandoc/index.html">Convert a Document To PDF With Pandoc</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="convert-a-document-to-pdf-with-pandoc/index.html" rel="bookmark"><time class="published dt-published" datetime="2023-11-28T13:45:17-08:00" itemprop="datePublished" title="2023-11-28 13:45">2023-11-28 13:45</time></a></p>
</div>
</header>
<div class="p-summary entry-summary">
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="convert-a-document-to-pdf-with-pandoc/index.html#org2d5b7e2">What's This About?</a></li>
<li><a href="convert-a-document-to-pdf-with-pandoc/index.html#orgc9cc44d">Headers</a>
<ul>
<li><a href="convert-a-document-to-pdf-with-pandoc/index.html#orgabb50f3">Libertinus</a></li>
<li><a href="convert-a-document-to-pdf-with-pandoc/index.html#org3c34b24">Pagella</a></li>
</ul>
</li>
<li><a href="convert-a-document-to-pdf-with-pandoc/index.html#org3fd93b9">The Function</a></li>
<li><a href="convert-a-document-to-pdf-with-pandoc/index.html#org8ef3aab">Links</a></li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org2d5b7e2">
<h2 id="org2d5b7e2">What's This About?</h2>
<div class="outline-text-2" id="text-org2d5b7e2">
<p>This is a function to help convert documents to PDF using pandoc. I was motivated to do this because the EPUB readers I tried (on Ubuntu) don't seem to do a good job of styling the text or providing the options to really let you do it (at least not easily through the GUI). Foliate seems to be the best for styling, but I occasionally run into EPUB files that it won't open so I thought it'd be useful to convert them to PDF sometimes.</p>
<p>Pandoc will convert an ePub or other formatted file to PDF (using <i>pdflatex</i>) without much configuration</p>
<div class="highlight">
<pre><span></span>pandoc inputfile.epub -o output.pdf
</pre></div>
<p>but it defaults to using <a href="https://en.wikipedia.org/wiki/Computer_Modern">Computer Modern</a>, making it look like those old Springer books in the library, so I thought I'd create this function to document how to change the font in case I forget later on.</p>
</div>
</div>
<div class="outline-2" id="outline-container-orgc9cc44d">
<h2 id="orgc9cc44d">Headers</h2>
<div class="outline-text-2" id="text-orgc9cc44d">
<p>You can set the font as a command line argument to pandoc (e.g. <code>-V fontfamily:libertine</code> ) but I thought it'd be better to create a tex header snippet so that I could add more configurations if I needed to.</p>
<p>The function is going to assume that the pagella snippet is in a folder in <code>~/.config/fish/extras/</code> which I created using a symlink to the <code>extras</code> folder in this repository, but it'll also take a path to the header if it's given.</p>
</div>
<div class="outline-3" id="outline-container-orgabb50f3">
<h3 id="orgabb50f3">Libertinus</h3>
<div class="outline-text-3" id="text-orgabb50f3">
<p>This is a font I ran into while searching around for instructions on changing the pandoc font. I'm not convinced it's better than Palatino, but it's better than Computer Modern, anyway.</p>
<div class="highlight">
<pre><span></span><span class="k">\usepackage</span><span class="nb">{</span>libertinus<span class="nb">}</span>
<span class="k">\usepackage</span><span class="na">[T1]</span><span class="nb">{</span>fontenc<span class="nb">}</span>
<span class="k">\usepackage</span><span class="nb">{</span>sectsty<span class="nb">}</span>
<span class="k">\sectionfont</span><span class="nb">{</span><span class="k">\clearpage</span><span class="nb">}</span>
</pre></div>
</div>
</div>
<div class="outline-3" id="outline-container-org3c34b24">
<h3 id="org3c34b24">Pagella</h3>
<div class="outline-text-3" id="text-org3c34b24">
<p>The Libertine/Libertinus font wasn't really what I was looking for so I made Tex Gyre Pagella version as well.</p>
<div class="highlight">
<pre><span></span><span class="k">\usepackage</span><span class="nb">{</span>tgpagella<span class="nb">}</span>
<span class="k">\usepackage</span><span class="na">[T1]</span><span class="nb">{</span>fontenc<span class="nb">}</span>
<span class="k">\usepackage</span><span class="nb">{</span>sectsty<span class="nb">}</span>
<span class="k">\sectionfont</span><span class="nb">{</span><span class="k">\clearpage</span><span class="nb">}</span>
</pre></div>
<div class="notecard" id="orgb620824">
<p><b>Note:</b> I originally accidentally put <i>pagella</i> and not <i>tgpagella</i> which took me a while to trouble-shoot, so for the future remember - it's "Tex Gyre Pagella" not just "Pagella". Also it's <i>sectsty</i> not <i>secsty</i>.</p>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org3fd93b9">
<h2 id="org3fd93b9">The Function</h2>
<div class="outline-text-2" id="text-org3fd93b9">
<p>Nothing fancy here, it just adds the extra header file. I originally added the <code>--table-of-contents</code> flag but it creates one from the EPUB anyway so that caused it to have two tables of contents.</p>
<div class="highlight">
<pre><span></span><span class="k">function</span> doc2pdf -d <span class="s2">"Convert document to pdf with pandoc"</span> --argument-names SOURCE HEADER
    <span class="k">set</span> TARGET <span class="nv">$(</span>path change-extension pdf <span class="nv">$SOURCE</span><span class="o">)</span>

    <span class="k">if</span> <span class="k">test</span> -z <span class="nv">$HEADER</span>
        <span class="k">set</span> HEADER ~/.config/fish/extras/pagella.tex
    <span class="k">end</span>

    pandoc --standalone <span class="nv">$SOURCE</span> --output <span class="nv">$TARGET</span> --include-in-header <span class="nv">$HEADER</span>
<span class="k">end</span>
</pre></div>
</div>
</div>
<div class="outline-2" id="outline-container-org8ef3aab">
<h2 id="org8ef3aab">Links</h2>
<div class="outline-text-2" id="text-org8ef3aab">
<ul class="org-ul">
<li><a href="https://learnbyexample.github.io/customizing-pandoc/">learnbyexample</a> : "Customizing pandoc to generate beautiful pdf and epub from markdown" - shows how to include extra tex header information and other pandoc options to customize PDF output</li>
<li><a href="https://tug.org/FontCatalogue/texgyrepagella/">Latex Font Catalogue</a> : Tex Gyre Pagella page</li>
<li><a href="https://tug.org/FontCatalogue/linuxlibertine/">Latex Font Catalogue</a> : Linux Libertine Page</li>
<li><a href="https://tug.org/FontCatalogue/libertinusserif/">Latex Font Catalogue</a> : Libertinus Serif Page</li>
<li><a href="https://github.com/alerque/libertinus">GitHub</a>: The Libertinus repository page</li>
<li><a href="https://en.wikipedia.org/wiki/Linux_Libertine">Wikipedia</a> : Libertine and Libertinus information</li>
<li><a href="rst2org-function/index.html">rst2org Function</a>: Another function using pandoc.</li>
</ul>
</div>
</div>
</div>
</article>
</div>
<ul class="pager postindexpager clearfix">
<li class="next"><a href="index-2.html" rel="next">Older posts</a></li>
</ul>
<!--End of body content-->
<footer id="footer">Scribbled by the <a href="mailto:cloisteredmonkey.jmark@slmail.me">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a>
<div id="license" xmlns:cc="http://creativecommons.org/ns#">This work is licensed under <a href="http://creativecommons.org/licenses/by/4.0/?ref=chooser-v1" rel="license noopener noreferrer" style="display:inline-block;" target="_blank">CC BY 4.0 <img src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"></a></div>
</footer>
</div>
</div>
<script src="../assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
</script>
</body>
</html>
